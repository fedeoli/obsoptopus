%% EKF A matrix numeric %%
function A = Amatrix_EKF_v1(map,params,x,y)

    % quaternion
    q0 = x(1);
    q1 = x(2);
    q2 = x(3);
    q3 = x(4);
    
    % omega
    wx = x(5);
    wy = x(6);
    wz = x(7);
    
    % magnetometers
    if map.nMagneto >= 1
        Bx1 = y(4);
        By1 = y(5);
        Bz1 = y(6);
    end
    if map.nMagneto >= 2
        Bx2 = y(7);
        By2 = y(8);
        Bz2 = y(9);
    end
    
    %%% params %%%
    Ixx = params.sat(1).I(1,1);
    Iyy = params.sat(1).I(2,2);
    Izz = params.sat(1).I(3,3);
    mie = params.mi;
    r = params.SatellitesCoordinates(1:3);
    rx = r(1);
    ry = r(2);
    rz = r(3);
    r_norm = norm(r);
    
    % first elements
    A = [   0, -wx/2, -wy/2, -wz/2, -q1/2, -q2/2, -q3/2;
         wx/2,     0,  wz/2, -wy/2,  q0/2, -q3/2,  q2/2;
         wy/2, -wz/2,     0,  wx/2,  q3/2,  q0/2, -q1/2;
         wz/2,  wy/2, -wx/2,     0, -q2/2,  q1/2,  q0/2];
     
    % second elements
    A(5:7,1) = [(6*Iyy*mie*q3^3*ry^2 - 6*Iyy*mie*q3^3*rz^2 - 6*Izz*mie*q3^3*ry^2 + 6*Izz*mie*q3^3*rz^2 - 12*Iyy*mie*q1^2*q3*rx^2 + 12*Iyy*mie*q2^2*q3*rx^2 - 18*Iyy*mie*q0^2*q3*ry^2 + 6*Iyy*mie*q1^2*q3*ry^2 - 6*Iyy*mie*q2^2*q3*ry^2 + 12*Izz*mie*q1^2*q3*rx^2 - 12*Izz*mie*q2^2*q3*rx^2 + 18*Iyy*mie*q0^2*q3*rz^2 + 6*Iyy*mie*q1^2*q3*rz^2 - 6*Iyy*mie*q2^2*q3*rz^2 + 18*Izz*mie*q0^2*q3*ry^2 - 6*Izz*mie*q1^2*q3*ry^2 + 6*Izz*mie*q2^2*q3*ry^2 - 18*Izz*mie*q0^2*q3*rz^2 - 6*Izz*mie*q1^2*q3*rz^2 + 6*Izz*mie*q2^2*q3*rz^2 + 4*Iyy*q0^3*r_norm^5*wy*wz - 4*Izz*q0^3*r_norm^5*wy*wz + 6*Iyy*mie*q2^3*rx*ry + 6*Iyy*mie*q1^3*rx*rz - 6*Izz*mie*q2^3*rx*ry - 12*Iyy*mie*q0^3*ry*rz - 6*Izz*mie*q1^3*rx*rz + 12*Izz*mie*q0^3*ry*rz - 24*Iyy*mie*q0*q1*q2*rx^2 + 12*Iyy*mie*q0*q1*q2*ry^2 + 24*Izz*mie*q0*q1*q2*rx^2 + 12*Iyy*mie*q0*q1*q2*rz^2 - 12*Izz*mie*q0*q1*q2*ry^2 - 12*Izz*mie*q0*q1*q2*rz^2 + 18*Iyy*mie*q0^2*q2*rx*ry - 18*Iyy*mie*q1^2*q2*rx*ry - 18*Iyy*mie*q2*q3^2*rx*ry + 18*Iyy*mie*q0^2*q1*rx*rz - 18*Iyy*mie*q1*q2^2*rx*rz - 18*Iyy*mie*q1*q3^2*rx*rz - 18*Izz*mie*q0^2*q2*rx*ry + 18*Izz*mie*q1^2*q2*rx*ry + 18*Izz*mie*q2*q3^2*rx*ry + 36*Iyy*mie*q0*q3^2*ry*rz - 18*Izz*mie*q0^2*q1*rx*rz + 18*Izz*mie*q1*q2^2*rx*rz + 18*Izz*mie*q1*q3^2*rx*rz - 36*Izz*mie*q0*q3^2*ry*rz + 4*Iyy*q0*q1^2*r_norm^5*wy*wz + 4*Iyy*q0*q2^2*r_norm^5*wy*wz + 4*Iyy*q0*q3^2*r_norm^5*wy*wz - 4*Izz*q0*q1^2*r_norm^5*wy*wz - 4*Izz*q0*q2^2*r_norm^5*wy*wz - 4*Izz*q0*q3^2*r_norm^5*wy*wz + 36*Iyy*mie*q0*q1*q3*rx*ry - 36*Iyy*mie*q0*q2*q3*rx*rz - 36*Izz*mie*q0*q1*q3*rx*ry + 36*Izz*mie*q0*q2*q3*rx*rz)/(Ixx*r_norm^5*(q0^2 + q1^2 + q2^2 + q3^2)^2) - (4*q0*(6*Iyy*mie*q0*q3^3*ry^2 + 6*Iyy*mie*q1*q2^3*ry^2 - 6*Iyy*mie*q0^3*q3*ry^2 - 6*Iyy*mie*q1^3*q2*ry^2 - 6*Iyy*mie*q0*q3^3*rz^2 - 6*Iyy*mie*q1*q2^3*rz^2 + 6*Iyy*mie*q0^3*q3*rz^2 + 6*Iyy*mie*q1^3*q2*rz^2 - 6*Izz*mie*q0*q3^3*ry^2 - 6*Izz*mie*q1*q2^3*ry^2 + 6*Izz*mie*q0^3*q3*ry^2 + 6*Izz*mie*q1^3*q2*ry^2 + 6*Izz*mie*q0*q3^3*rz^2 + 6*Izz*mie*q1*q2^3*rz^2 - 6*Izz*mie*q0^3*q3*rz^2 - 6*Izz*mie*q1^3*q2*rz^2 + Iyy*q0^4*r_norm^5*wy*wz + Iyy*q1^4*r_norm^5*wy*wz + Iyy*q2^4*r_norm^5*wy*wz + Iyy*q3^4*r_norm^5*wy*wz - Izz*q0^4*r_norm^5*wy*wz - Izz*q1^4*r_norm^5*wy*wz - Izz*q2^4*r_norm^5*wy*wz - Izz*q3^4*r_norm^5*wy*wz - 3*Iyy*mie*q0^4*ry*rz + 3*Iyy*mie*q1^4*ry*rz + 3*Iyy*mie*q2^4*ry*rz - 3*Iyy*mie*q3^4*ry*rz + 3*Izz*mie*q0^4*ry*rz - 3*Izz*mie*q1^4*ry*rz - 3*Izz*mie*q2^4*ry*rz + 3*Izz*mie*q3^4*ry*rz + 2*Iyy*q0^2*q1^2*r_norm^5*wy*wz + 2*Iyy*q0^2*q2^2*r_norm^5*wy*wz + 2*Iyy*q0^2*q3^2*r_norm^5*wy*wz + 2*Iyy*q1^2*q2^2*r_norm^5*wy*wz + 2*Iyy*q1^2*q3^2*r_norm^5*wy*wz + 2*Iyy*q2^2*q3^2*r_norm^5*wy*wz - 2*Izz*q0^2*q1^2*r_norm^5*wy*wz - 2*Izz*q0^2*q2^2*r_norm^5*wy*wz - 2*Izz*q0^2*q3^2*r_norm^5*wy*wz - 2*Izz*q1^2*q2^2*r_norm^5*wy*wz - 2*Izz*q1^2*q3^2*r_norm^5*wy*wz - 2*Izz*q2^2*q3^2*r_norm^5*wy*wz + 6*Iyy*mie*q0*q2^3*rx*ry + 6*Iyy*mie*q0^3*q2*rx*ry - 6*Iyy*mie*q1*q3^3*rx*ry - 6*Iyy*mie*q1^3*q3*rx*ry + 6*Iyy*mie*q0*q1^3*rx*rz + 6*Iyy*mie*q0^3*q1*rx*rz + 6*Iyy*mie*q2*q3^3*rx*rz + 6*Iyy*mie*q2^3*q3*rx*rz - 6*Izz*mie*q0*q2^3*rx*ry - 6*Izz*mie*q0^3*q2*rx*ry + 6*Izz*mie*q1*q3^3*rx*ry + 6*Izz*mie*q1^3*q3*rx*ry - 6*Izz*mie*q0*q1^3*rx*rz - 6*Izz*mie*q0^3*q1*rx*rz - 6*Izz*mie*q2*q3^3*rx*rz - 6*Izz*mie*q2^3*q3*rx*rz - 12*Iyy*mie*q0^2*q1*q2*rx^2 - 12*Iyy*mie*q0*q1^2*q3*rx^2 + 12*Iyy*mie*q0*q2^2*q3*rx^2 + 12*Iyy*mie*q1*q2*q3^2*rx^2 + 6*Iyy*mie*q0^2*q1*q2*ry^2 + 6*Iyy*mie*q0*q1^2*q3*ry^2 - 6*Iyy*mie*q0*q2^2*q3*ry^2 - 6*Iyy*mie*q1*q2*q3^2*ry^2 + 12*Izz*mie*q0^2*q1*q2*rx^2 + 12*Izz*mie*q0*q1^2*q3*rx^2 - 12*Izz*mie*q0*q2^2*q3*rx^2 - 12*Izz*mie*q1*q2*q3^2*rx^2 + 6*Iyy*mie*q0^2*q1*q2*rz^2 + 6*Iyy*mie*q0*q1^2*q3*rz^2 - 6*Iyy*mie*q0*q2^2*q3*rz^2 - 6*Iyy*mie*q1*q2*q3^2*rz^2 - 6*Izz*mie*q0^2*q1*q2*ry^2 - 6*Izz*mie*q0*q1^2*q3*ry^2 + 6*Izz*mie*q0*q2^2*q3*ry^2 + 6*Izz*mie*q1*q2*q3^2*ry^2 - 6*Izz*mie*q0^2*q1*q2*rz^2 - 6*Izz*mie*q0*q1^2*q3*rz^2 + 6*Izz*mie*q0*q2^2*q3*rz^2 + 6*Izz*mie*q1*q2*q3^2*rz^2 + 18*Iyy*mie*q0^2*q3^2*ry*rz - 18*Iyy*mie*q1^2*q2^2*ry*rz - 18*Izz*mie*q0^2*q3^2*ry*rz + 18*Izz*mie*q1^2*q2^2*ry*rz - 18*Iyy*mie*q0*q1^2*q2*rx*ry + 18*Iyy*mie*q0^2*q1*q3*rx*ry - 18*Iyy*mie*q0*q2*q3^2*rx*ry + 18*Iyy*mie*q1*q2^2*q3*rx*ry - 18*Iyy*mie*q0*q1*q2^2*rx*rz - 18*Iyy*mie*q0*q1*q3^2*rx*rz - 18*Iyy*mie*q0^2*q2*q3*rx*rz - 18*Iyy*mie*q1^2*q2*q3*rx*rz + 18*Izz*mie*q0*q1^2*q2*rx*ry - 18*Izz*mie*q0^2*q1*q3*rx*ry + 18*Izz*mie*q0*q2*q3^2*rx*ry - 18*Izz*mie*q1*q2^2*q3*rx*ry + 18*Izz*mie*q0*q1*q2^2*rx*rz + 18*Izz*mie*q0*q1*q3^2*rx*rz + 18*Izz*mie*q0^2*q2*q3*rx*rz + 18*Izz*mie*q1^2*q2*q3*rx*rz))/(Ixx*r_norm^5*(q0^2 + q1^2 + q2^2 + q3^2)^3);
                (4*q0*(6*Ixx*mie*q0*q2^3*rx^2 - 6*Ixx*mie*q0^3*q2*rx^2 - 6*Ixx*mie*q1*q3^3*rx^2 + 6*Ixx*mie*q1^3*q3*rx^2 - 6*Ixx*mie*q0*q2^3*rz^2 + 6*Ixx*mie*q0^3*q2*rz^2 + 6*Ixx*mie*q1*q3^3*rz^2 - 6*Ixx*mie*q1^3*q3*rz^2 - 6*Izz*mie*q0*q2^3*rx^2 + 6*Izz*mie*q0^3*q2*rx^2 + 6*Izz*mie*q1*q3^3*rx^2 - 6*Izz*mie*q1^3*q3*rx^2 + 6*Izz*mie*q0*q2^3*rz^2 - 6*Izz*mie*q0^3*q2*rz^2 - 6*Izz*mie*q1*q3^3*rz^2 + 6*Izz*mie*q1^3*q3*rz^2 + Ixx*q0^4*r_norm^5*wx*wz + Ixx*q1^4*r_norm^5*wx*wz + Ixx*q2^4*r_norm^5*wx*wz + Ixx*q3^4*r_norm^5*wx*wz - Izz*q0^4*r_norm^5*wx*wz - Izz*q1^4*r_norm^5*wx*wz - Izz*q2^4*r_norm^5*wx*wz - Izz*q3^4*r_norm^5*wx*wz + 3*Ixx*mie*q0^4*rx*rz - 3*Ixx*mie*q1^4*rx*rz + 3*Ixx*mie*q2^4*rx*rz - 3*Ixx*mie*q3^4*rx*rz - 3*Izz*mie*q0^4*rx*rz + 3*Izz*mie*q1^4*rx*rz - 3*Izz*mie*q2^4*rx*rz + 3*Izz*mie*q3^4*rx*rz + 2*Ixx*q0^2*q1^2*r_norm^5*wx*wz + 2*Ixx*q0^2*q2^2*r_norm^5*wx*wz + 2*Ixx*q0^2*q3^2*r_norm^5*wx*wz + 2*Ixx*q1^2*q2^2*r_norm^5*wx*wz + 2*Ixx*q1^2*q3^2*r_norm^5*wx*wz + 2*Ixx*q2^2*q3^2*r_norm^5*wx*wz - 2*Izz*q0^2*q1^2*r_norm^5*wx*wz - 2*Izz*q0^2*q2^2*r_norm^5*wx*wz - 2*Izz*q0^2*q3^2*r_norm^5*wx*wz - 2*Izz*q1^2*q2^2*r_norm^5*wx*wz - 2*Izz*q1^2*q3^2*r_norm^5*wx*wz - 2*Izz*q2^2*q3^2*r_norm^5*wx*wz + 6*Ixx*mie*q0*q3^3*rx*ry + 6*Ixx*mie*q1*q2^3*rx*ry + 6*Ixx*mie*q0^3*q3*rx*ry + 6*Ixx*mie*q1^3*q2*rx*ry + 6*Ixx*mie*q0*q1^3*ry*rz + 6*Ixx*mie*q0^3*q1*ry*rz - 6*Ixx*mie*q2*q3^3*ry*rz - 6*Ixx*mie*q2^3*q3*ry*rz - 6*Izz*mie*q0*q3^3*rx*ry - 6*Izz*mie*q1*q2^3*rx*ry - 6*Izz*mie*q0^3*q3*rx*ry - 6*Izz*mie*q1^3*q2*rx*ry - 6*Izz*mie*q0*q1^3*ry*rz - 6*Izz*mie*q0^3*q1*ry*rz + 6*Izz*mie*q2*q3^3*ry*rz + 6*Izz*mie*q2^3*q3*ry*rz + 6*Ixx*mie*q0*q1^2*q2*rx^2 - 6*Ixx*mie*q0^2*q1*q3*rx^2 - 6*Ixx*mie*q0*q2*q3^2*rx^2 + 6*Ixx*mie*q1*q2^2*q3*rx^2 - 12*Ixx*mie*q0*q1^2*q2*ry^2 + 12*Ixx*mie*q0^2*q1*q3*ry^2 + 12*Ixx*mie*q0*q2*q3^2*ry^2 - 12*Ixx*mie*q1*q2^2*q3*ry^2 + 6*Ixx*mie*q0*q1^2*q2*rz^2 - 6*Ixx*mie*q0^2*q1*q3*rz^2 - 6*Ixx*mie*q0*q2*q3^2*rz^2 + 6*Ixx*mie*q1*q2^2*q3*rz^2 - 6*Izz*mie*q0*q1^2*q2*rx^2 + 6*Izz*mie*q0^2*q1*q3*rx^2 + 6*Izz*mie*q0*q2*q3^2*rx^2 - 6*Izz*mie*q1*q2^2*q3*rx^2 + 12*Izz*mie*q0*q1^2*q2*ry^2 - 12*Izz*mie*q0^2*q1*q3*ry^2 - 12*Izz*mie*q0*q2*q3^2*ry^2 + 12*Izz*mie*q1*q2^2*q3*ry^2 - 6*Izz*mie*q0*q1^2*q2*rz^2 + 6*Izz*mie*q0^2*q1*q3*rz^2 + 6*Izz*mie*q0*q2*q3^2*rz^2 - 6*Izz*mie*q1*q2^2*q3*rz^2 - 18*Ixx*mie*q0^2*q2^2*rx*rz + 18*Ixx*mie*q1^2*q3^2*rx*rz + 18*Izz*mie*q0^2*q2^2*rx*rz - 18*Izz*mie*q1^2*q3^2*rx*rz - 18*Ixx*mie*q0^2*q1*q2*rx*ry - 18*Ixx*mie*q0*q1^2*q3*rx*ry - 18*Ixx*mie*q0*q2^2*q3*rx*ry - 18*Ixx*mie*q1*q2*q3^2*rx*ry - 18*Ixx*mie*q0*q1*q2^2*ry*rz - 18*Ixx*mie*q0*q1*q3^2*ry*rz + 18*Ixx*mie*q0^2*q2*q3*ry*rz + 18*Ixx*mie*q1^2*q2*q3*ry*rz + 18*Izz*mie*q0^2*q1*q2*rx*ry + 18*Izz*mie*q0*q1^2*q3*rx*ry + 18*Izz*mie*q0*q2^2*q3*rx*ry + 18*Izz*mie*q1*q2*q3^2*rx*ry + 18*Izz*mie*q0*q1*q2^2*ry*rz + 18*Izz*mie*q0*q1*q3^2*ry*rz - 18*Izz*mie*q0^2*q2*q3*ry*rz - 18*Izz*mie*q1^2*q2*q3*ry*rz))/(Iyy*r_norm^5*(q0^2 + q1^2 + q2^2 + q3^2)^3) - (6*Ixx*mie*q2^3*rx^2 - 6*Ixx*mie*q2^3*rz^2 - 6*Izz*mie*q2^3*rx^2 + 6*Izz*mie*q2^3*rz^2 - 18*Ixx*mie*q0^2*q2*rx^2 + 6*Ixx*mie*q1^2*q2*rx^2 - 6*Ixx*mie*q2*q3^2*rx^2 - 12*Ixx*mie*q1^2*q2*ry^2 + 12*Ixx*mie*q2*q3^2*ry^2 + 18*Ixx*mie*q0^2*q2*rz^2 + 6*Ixx*mie*q1^2*q2*rz^2 - 6*Ixx*mie*q2*q3^2*rz^2 + 18*Izz*mie*q0^2*q2*rx^2 - 6*Izz*mie*q1^2*q2*rx^2 + 6*Izz*mie*q2*q3^2*rx^2 + 12*Izz*mie*q1^2*q2*ry^2 - 12*Izz*mie*q2*q3^2*ry^2 - 18*Izz*mie*q0^2*q2*rz^2 - 6*Izz*mie*q1^2*q2*rz^2 + 6*Izz*mie*q2*q3^2*rz^2 + 4*Ixx*q0^3*r_norm^5*wx*wz - 4*Izz*q0^3*r_norm^5*wx*wz + 6*Ixx*mie*q3^3*rx*ry + 12*Ixx*mie*q0^3*rx*rz + 6*Ixx*mie*q1^3*ry*rz - 6*Izz*mie*q3^3*rx*ry - 12*Izz*mie*q0^3*rx*rz - 6*Izz*mie*q1^3*ry*rz - 12*Ixx*mie*q0*q1*q3*rx^2 + 24*Ixx*mie*q0*q1*q3*ry^2 - 12*Ixx*mie*q0*q1*q3*rz^2 + 12*Izz*mie*q0*q1*q3*rx^2 - 24*Izz*mie*q0*q1*q3*ry^2 + 12*Izz*mie*q0*q1*q3*rz^2 + 18*Ixx*mie*q0^2*q3*rx*ry - 18*Ixx*mie*q1^2*q3*rx*ry - 18*Ixx*mie*q2^2*q3*rx*ry - 36*Ixx*mie*q0*q2^2*rx*rz + 18*Ixx*mie*q0^2*q1*ry*rz - 18*Ixx*mie*q1*q2^2*ry*rz - 18*Ixx*mie*q1*q3^2*ry*rz - 18*Izz*mie*q0^2*q3*rx*ry + 18*Izz*mie*q1^2*q3*rx*ry + 18*Izz*mie*q2^2*q3*rx*ry + 36*Izz*mie*q0*q2^2*rx*rz - 18*Izz*mie*q0^2*q1*ry*rz + 18*Izz*mie*q1*q2^2*ry*rz + 18*Izz*mie*q1*q3^2*ry*rz + 4*Ixx*q0*q1^2*r_norm^5*wx*wz + 4*Ixx*q0*q2^2*r_norm^5*wx*wz + 4*Ixx*q0*q3^2*r_norm^5*wx*wz - 4*Izz*q0*q1^2*r_norm^5*wx*wz - 4*Izz*q0*q2^2*r_norm^5*wx*wz - 4*Izz*q0*q3^2*r_norm^5*wx*wz - 36*Ixx*mie*q0*q1*q2*rx*ry + 36*Ixx*mie*q0*q2*q3*ry*rz + 36*Izz*mie*q0*q1*q2*rx*ry - 36*Izz*mie*q0*q2*q3*ry*rz)/(Iyy*r_norm^5*(q0^2 + q1^2 + q2^2 + q3^2)^2);
                (6*Ixx*mie*q1^3*rx^2 - 6*Ixx*mie*q1^3*ry^2 - 6*Iyy*mie*q1^3*rx^2 + 6*Iyy*mie*q1^3*ry^2 - 18*Ixx*mie*q0^2*q1*rx^2 + 6*Ixx*mie*q1*q2^2*rx^2 - 6*Ixx*mie*q1*q3^2*rx^2 + 18*Ixx*mie*q0^2*q1*ry^2 + 6*Ixx*mie*q1*q2^2*ry^2 - 6*Ixx*mie*q1*q3^2*ry^2 + 18*Iyy*mie*q0^2*q1*rx^2 - 6*Iyy*mie*q1*q2^2*rx^2 + 6*Iyy*mie*q1*q3^2*rx^2 - 12*Ixx*mie*q1*q2^2*rz^2 + 12*Ixx*mie*q1*q3^2*rz^2 - 18*Iyy*mie*q0^2*q1*ry^2 - 6*Iyy*mie*q1*q2^2*ry^2 + 6*Iyy*mie*q1*q3^2*ry^2 + 12*Iyy*mie*q1*q2^2*rz^2 - 12*Iyy*mie*q1*q3^2*rz^2 + 4*Ixx*q0^3*r_norm^5*wx*wy - 4*Iyy*q0^3*r_norm^5*wx*wy + 12*Ixx*mie*q0^3*rx*ry - 6*Ixx*mie*q3^3*rx*rz - 12*Iyy*mie*q0^3*rx*ry + 6*Ixx*mie*q2^3*ry*rz + 6*Iyy*mie*q3^3*rx*rz - 6*Iyy*mie*q2^3*ry*rz + 12*Ixx*mie*q0*q2*q3*rx^2 + 12*Ixx*mie*q0*q2*q3*ry^2 - 12*Iyy*mie*q0*q2*q3*rx^2 - 24*Ixx*mie*q0*q2*q3*rz^2 - 12*Iyy*mie*q0*q2*q3*ry^2 + 24*Iyy*mie*q0*q2*q3*rz^2 - 36*Ixx*mie*q0*q1^2*rx*ry - 18*Ixx*mie*q0^2*q3*rx*rz + 18*Ixx*mie*q1^2*q3*rx*rz + 18*Ixx*mie*q2^2*q3*rx*rz + 36*Iyy*mie*q0*q1^2*rx*ry + 18*Ixx*mie*q0^2*q2*ry*rz - 18*Ixx*mie*q1^2*q2*ry*rz - 18*Ixx*mie*q2*q3^2*ry*rz + 18*Iyy*mie*q0^2*q3*rx*rz - 18*Iyy*mie*q1^2*q3*rx*rz - 18*Iyy*mie*q2^2*q3*rx*rz - 18*Iyy*mie*q0^2*q2*ry*rz + 18*Iyy*mie*q1^2*q2*ry*rz + 18*Iyy*mie*q2*q3^2*ry*rz + 4*Ixx*q0*q1^2*r_norm^5*wx*wy + 4*Ixx*q0*q2^2*r_norm^5*wx*wy + 4*Ixx*q0*q3^2*r_norm^5*wx*wy - 4*Iyy*q0*q1^2*r_norm^5*wx*wy - 4*Iyy*q0*q2^2*r_norm^5*wx*wy - 4*Iyy*q0*q3^2*r_norm^5*wx*wy - 36*Ixx*mie*q0*q1*q2*rx*rz - 36*Ixx*mie*q0*q1*q3*ry*rz + 36*Iyy*mie*q0*q1*q2*rx*rz + 36*Iyy*mie*q0*q1*q3*ry*rz)/(Izz*r_norm^5*(q0^2 + q1^2 + q2^2 + q3^2)^2) - (4*q0*(6*Ixx*mie*q0*q1^3*rx^2 - 6*Ixx*mie*q0^3*q1*rx^2 + 6*Ixx*mie*q2*q3^3*rx^2 - 6*Ixx*mie*q2^3*q3*rx^2 - 6*Ixx*mie*q0*q1^3*ry^2 + 6*Ixx*mie*q0^3*q1*ry^2 - 6*Ixx*mie*q2*q3^3*ry^2 + 6*Ixx*mie*q2^3*q3*ry^2 - 6*Iyy*mie*q0*q1^3*rx^2 + 6*Iyy*mie*q0^3*q1*rx^2 - 6*Iyy*mie*q2*q3^3*rx^2 + 6*Iyy*mie*q2^3*q3*rx^2 + 6*Iyy*mie*q0*q1^3*ry^2 - 6*Iyy*mie*q0^3*q1*ry^2 + 6*Iyy*mie*q2*q3^3*ry^2 - 6*Iyy*mie*q2^3*q3*ry^2 + Ixx*q0^4*r_norm^5*wx*wy + Ixx*q1^4*r_norm^5*wx*wy + Ixx*q2^4*r_norm^5*wx*wy + Ixx*q3^4*r_norm^5*wx*wy - Iyy*q0^4*r_norm^5*wx*wy - Iyy*q1^4*r_norm^5*wx*wy - Iyy*q2^4*r_norm^5*wx*wy - Iyy*q3^4*r_norm^5*wx*wy + 3*Ixx*mie*q0^4*rx*ry + 3*Ixx*mie*q1^4*rx*ry - 3*Ixx*mie*q2^4*rx*ry - 3*Ixx*mie*q3^4*rx*ry - 3*Iyy*mie*q0^4*rx*ry - 3*Iyy*mie*q1^4*rx*ry + 3*Iyy*mie*q2^4*rx*ry + 3*Iyy*mie*q3^4*rx*ry + 2*Ixx*q0^2*q1^2*r_norm^5*wx*wy + 2*Ixx*q0^2*q2^2*r_norm^5*wx*wy + 2*Ixx*q0^2*q3^2*r_norm^5*wx*wy + 2*Ixx*q1^2*q2^2*r_norm^5*wx*wy + 2*Ixx*q1^2*q3^2*r_norm^5*wx*wy + 2*Ixx*q2^2*q3^2*r_norm^5*wx*wy - 2*Iyy*q0^2*q1^2*r_norm^5*wx*wy - 2*Iyy*q0^2*q2^2*r_norm^5*wx*wy - 2*Iyy*q0^2*q3^2*r_norm^5*wx*wy - 2*Iyy*q1^2*q2^2*r_norm^5*wx*wy - 2*Iyy*q1^2*q3^2*r_norm^5*wx*wy - 2*Iyy*q2^2*q3^2*r_norm^5*wx*wy - 6*Ixx*mie*q0*q3^3*rx*rz + 6*Ixx*mie*q1*q2^3*rx*rz - 6*Ixx*mie*q0^3*q3*rx*rz + 6*Ixx*mie*q1^3*q2*rx*rz + 6*Ixx*mie*q0*q2^3*ry*rz + 6*Ixx*mie*q0^3*q2*ry*rz + 6*Ixx*mie*q1*q3^3*ry*rz + 6*Ixx*mie*q1^3*q3*ry*rz + 6*Iyy*mie*q0*q3^3*rx*rz - 6*Iyy*mie*q1*q2^3*rx*rz + 6*Iyy*mie*q0^3*q3*rx*rz - 6*Iyy*mie*q1^3*q2*rx*rz - 6*Iyy*mie*q0*q2^3*ry*rz - 6*Iyy*mie*q0^3*q2*ry*rz - 6*Iyy*mie*q1*q3^3*ry*rz - 6*Iyy*mie*q1^3*q3*ry*rz + 6*Ixx*mie*q0*q1*q2^2*rx^2 - 6*Ixx*mie*q0*q1*q3^2*rx^2 + 6*Ixx*mie*q0^2*q2*q3*rx^2 - 6*Ixx*mie*q1^2*q2*q3*rx^2 + 6*Ixx*mie*q0*q1*q2^2*ry^2 - 6*Ixx*mie*q0*q1*q3^2*ry^2 + 6*Ixx*mie*q0^2*q2*q3*ry^2 - 6*Ixx*mie*q1^2*q2*q3*ry^2 - 6*Iyy*mie*q0*q1*q2^2*rx^2 + 6*Iyy*mie*q0*q1*q3^2*rx^2 - 6*Iyy*mie*q0^2*q2*q3*rx^2 + 6*Iyy*mie*q1^2*q2*q3*rx^2 - 12*Ixx*mie*q0*q1*q2^2*rz^2 + 12*Ixx*mie*q0*q1*q3^2*rz^2 - 12*Ixx*mie*q0^2*q2*q3*rz^2 + 12*Ixx*mie*q1^2*q2*q3*rz^2 - 6*Iyy*mie*q0*q1*q2^2*ry^2 + 6*Iyy*mie*q0*q1*q3^2*ry^2 - 6*Iyy*mie*q0^2*q2*q3*ry^2 + 6*Iyy*mie*q1^2*q2*q3*ry^2 + 12*Iyy*mie*q0*q1*q2^2*rz^2 - 12*Iyy*mie*q0*q1*q3^2*rz^2 + 12*Iyy*mie*q0^2*q2*q3*rz^2 - 12*Iyy*mie*q1^2*q2*q3*rz^2 - 18*Ixx*mie*q0^2*q1^2*rx*ry + 18*Ixx*mie*q2^2*q3^2*rx*ry + 18*Iyy*mie*q0^2*q1^2*rx*ry - 18*Iyy*mie*q2^2*q3^2*rx*ry - 18*Ixx*mie*q0^2*q1*q2*rx*rz + 18*Ixx*mie*q0*q1^2*q3*rx*rz + 18*Ixx*mie*q0*q2^2*q3*rx*rz - 18*Ixx*mie*q1*q2*q3^2*rx*rz - 18*Ixx*mie*q0*q1^2*q2*ry*rz - 18*Ixx*mie*q0^2*q1*q3*ry*rz - 18*Ixx*mie*q0*q2*q3^2*ry*rz - 18*Ixx*mie*q1*q2^2*q3*ry*rz + 18*Iyy*mie*q0^2*q1*q2*rx*rz - 18*Iyy*mie*q0*q1^2*q3*rx*rz - 18*Iyy*mie*q0*q2^2*q3*rx*rz + 18*Iyy*mie*q1*q2*q3^2*rx*rz + 18*Iyy*mie*q0*q1^2*q2*ry*rz + 18*Iyy*mie*q0^2*q1*q3*ry*rz + 18*Iyy*mie*q0*q2*q3^2*ry*rz + 18*Iyy*mie*q1*q2^2*q3*ry*rz))/(Izz*r_norm^5*(q0^2 + q1^2 + q2^2 + q3^2)^3)];
            
    A(5:7,2) = [(6*Iyy*mie*q2^3*ry^2 - 6*Iyy*mie*q2^3*rz^2 - 6*Izz*mie*q2^3*ry^2 + 6*Izz*mie*q2^3*rz^2 - 12*Iyy*mie*q0^2*q2*rx^2 + 12*Iyy*mie*q2*q3^2*rx^2 + 6*Iyy*mie*q0^2*q2*ry^2 - 18*Iyy*mie*q1^2*q2*ry^2 - 6*Iyy*mie*q2*q3^2*ry^2 + 12*Izz*mie*q0^2*q2*rx^2 - 12*Izz*mie*q2*q3^2*rx^2 + 6*Iyy*mie*q0^2*q2*rz^2 + 18*Iyy*mie*q1^2*q2*rz^2 - 6*Iyy*mie*q2*q3^2*rz^2 - 6*Izz*mie*q0^2*q2*ry^2 + 18*Izz*mie*q1^2*q2*ry^2 + 6*Izz*mie*q2*q3^2*ry^2 - 6*Izz*mie*q0^2*q2*rz^2 - 18*Izz*mie*q1^2*q2*rz^2 + 6*Izz*mie*q2*q3^2*rz^2 + 4*Iyy*q1^3*r_norm^5*wy*wz - 4*Izz*q1^3*r_norm^5*wy*wz - 6*Iyy*mie*q3^3*rx*ry + 6*Iyy*mie*q0^3*rx*rz + 6*Izz*mie*q3^3*rx*ry + 12*Iyy*mie*q1^3*ry*rz - 6*Izz*mie*q0^3*rx*rz - 12*Izz*mie*q1^3*ry*rz - 24*Iyy*mie*q0*q1*q3*rx^2 + 12*Iyy*mie*q0*q1*q3*ry^2 + 24*Izz*mie*q0*q1*q3*rx^2 + 12*Iyy*mie*q0*q1*q3*rz^2 - 12*Izz*mie*q0*q1*q3*ry^2 - 12*Izz*mie*q0*q1*q3*rz^2 + 18*Iyy*mie*q0^2*q3*rx*ry - 18*Iyy*mie*q1^2*q3*rx*ry + 18*Iyy*mie*q2^2*q3*rx*ry + 18*Iyy*mie*q0*q1^2*rx*rz - 18*Iyy*mie*q0*q2^2*rx*rz - 18*Iyy*mie*q0*q3^2*rx*rz - 18*Izz*mie*q0^2*q3*rx*ry + 18*Izz*mie*q1^2*q3*rx*ry - 18*Izz*mie*q2^2*q3*rx*ry - 36*Iyy*mie*q1*q2^2*ry*rz - 18*Izz*mie*q0*q1^2*rx*rz + 18*Izz*mie*q0*q2^2*rx*rz + 18*Izz*mie*q0*q3^2*rx*rz + 36*Izz*mie*q1*q2^2*ry*rz + 4*Iyy*q0^2*q1*r_norm^5*wy*wz + 4*Iyy*q1*q2^2*r_norm^5*wy*wz + 4*Iyy*q1*q3^2*r_norm^5*wy*wz - 4*Izz*q0^2*q1*r_norm^5*wy*wz - 4*Izz*q1*q2^2*r_norm^5*wy*wz - 4*Izz*q1*q3^2*r_norm^5*wy*wz - 36*Iyy*mie*q0*q1*q2*rx*ry - 36*Iyy*mie*q1*q2*q3*rx*rz + 36*Izz*mie*q0*q1*q2*rx*ry + 36*Izz*mie*q1*q2*q3*rx*rz)/(Ixx*r_norm^5*(q0^2 + q1^2 + q2^2 + q3^2)^2) - (4*q1*(6*Iyy*mie*q0*q3^3*ry^2 + 6*Iyy*mie*q1*q2^3*ry^2 - 6*Iyy*mie*q0^3*q3*ry^2 - 6*Iyy*mie*q1^3*q2*ry^2 - 6*Iyy*mie*q0*q3^3*rz^2 - 6*Iyy*mie*q1*q2^3*rz^2 + 6*Iyy*mie*q0^3*q3*rz^2 + 6*Iyy*mie*q1^3*q2*rz^2 - 6*Izz*mie*q0*q3^3*ry^2 - 6*Izz*mie*q1*q2^3*ry^2 + 6*Izz*mie*q0^3*q3*ry^2 + 6*Izz*mie*q1^3*q2*ry^2 + 6*Izz*mie*q0*q3^3*rz^2 + 6*Izz*mie*q1*q2^3*rz^2 - 6*Izz*mie*q0^3*q3*rz^2 - 6*Izz*mie*q1^3*q2*rz^2 + Iyy*q0^4*r_norm^5*wy*wz + Iyy*q1^4*r_norm^5*wy*wz + Iyy*q2^4*r_norm^5*wy*wz + Iyy*q3^4*r_norm^5*wy*wz - Izz*q0^4*r_norm^5*wy*wz - Izz*q1^4*r_norm^5*wy*wz - Izz*q2^4*r_norm^5*wy*wz - Izz*q3^4*r_norm^5*wy*wz - 3*Iyy*mie*q0^4*ry*rz + 3*Iyy*mie*q1^4*ry*rz + 3*Iyy*mie*q2^4*ry*rz - 3*Iyy*mie*q3^4*ry*rz + 3*Izz*mie*q0^4*ry*rz - 3*Izz*mie*q1^4*ry*rz - 3*Izz*mie*q2^4*ry*rz + 3*Izz*mie*q3^4*ry*rz + 2*Iyy*q0^2*q1^2*r_norm^5*wy*wz + 2*Iyy*q0^2*q2^2*r_norm^5*wy*wz + 2*Iyy*q0^2*q3^2*r_norm^5*wy*wz + 2*Iyy*q1^2*q2^2*r_norm^5*wy*wz + 2*Iyy*q1^2*q3^2*r_norm^5*wy*wz + 2*Iyy*q2^2*q3^2*r_norm^5*wy*wz - 2*Izz*q0^2*q1^2*r_norm^5*wy*wz - 2*Izz*q0^2*q2^2*r_norm^5*wy*wz - 2*Izz*q0^2*q3^2*r_norm^5*wy*wz - 2*Izz*q1^2*q2^2*r_norm^5*wy*wz - 2*Izz*q1^2*q3^2*r_norm^5*wy*wz - 2*Izz*q2^2*q3^2*r_norm^5*wy*wz + 6*Iyy*mie*q0*q2^3*rx*ry + 6*Iyy*mie*q0^3*q2*rx*ry - 6*Iyy*mie*q1*q3^3*rx*ry - 6*Iyy*mie*q1^3*q3*rx*ry + 6*Iyy*mie*q0*q1^3*rx*rz + 6*Iyy*mie*q0^3*q1*rx*rz + 6*Iyy*mie*q2*q3^3*rx*rz + 6*Iyy*mie*q2^3*q3*rx*rz - 6*Izz*mie*q0*q2^3*rx*ry - 6*Izz*mie*q0^3*q2*rx*ry + 6*Izz*mie*q1*q3^3*rx*ry + 6*Izz*mie*q1^3*q3*rx*ry - 6*Izz*mie*q0*q1^3*rx*rz - 6*Izz*mie*q0^3*q1*rx*rz - 6*Izz*mie*q2*q3^3*rx*rz - 6*Izz*mie*q2^3*q3*rx*rz - 12*Iyy*mie*q0^2*q1*q2*rx^2 - 12*Iyy*mie*q0*q1^2*q3*rx^2 + 12*Iyy*mie*q0*q2^2*q3*rx^2 + 12*Iyy*mie*q1*q2*q3^2*rx^2 + 6*Iyy*mie*q0^2*q1*q2*ry^2 + 6*Iyy*mie*q0*q1^2*q3*ry^2 - 6*Iyy*mie*q0*q2^2*q3*ry^2 - 6*Iyy*mie*q1*q2*q3^2*ry^2 + 12*Izz*mie*q0^2*q1*q2*rx^2 + 12*Izz*mie*q0*q1^2*q3*rx^2 - 12*Izz*mie*q0*q2^2*q3*rx^2 - 12*Izz*mie*q1*q2*q3^2*rx^2 + 6*Iyy*mie*q0^2*q1*q2*rz^2 + 6*Iyy*mie*q0*q1^2*q3*rz^2 - 6*Iyy*mie*q0*q2^2*q3*rz^2 - 6*Iyy*mie*q1*q2*q3^2*rz^2 - 6*Izz*mie*q0^2*q1*q2*ry^2 - 6*Izz*mie*q0*q1^2*q3*ry^2 + 6*Izz*mie*q0*q2^2*q3*ry^2 + 6*Izz*mie*q1*q2*q3^2*ry^2 - 6*Izz*mie*q0^2*q1*q2*rz^2 - 6*Izz*mie*q0*q1^2*q3*rz^2 + 6*Izz*mie*q0*q2^2*q3*rz^2 + 6*Izz*mie*q1*q2*q3^2*rz^2 + 18*Iyy*mie*q0^2*q3^2*ry*rz - 18*Iyy*mie*q1^2*q2^2*ry*rz - 18*Izz*mie*q0^2*q3^2*ry*rz + 18*Izz*mie*q1^2*q2^2*ry*rz - 18*Iyy*mie*q0*q1^2*q2*rx*ry + 18*Iyy*mie*q0^2*q1*q3*rx*ry - 18*Iyy*mie*q0*q2*q3^2*rx*ry + 18*Iyy*mie*q1*q2^2*q3*rx*ry - 18*Iyy*mie*q0*q1*q2^2*rx*rz - 18*Iyy*mie*q0*q1*q3^2*rx*rz - 18*Iyy*mie*q0^2*q2*q3*rx*rz - 18*Iyy*mie*q1^2*q2*q3*rx*rz + 18*Izz*mie*q0*q1^2*q2*rx*ry - 18*Izz*mie*q0^2*q1*q3*rx*ry + 18*Izz*mie*q0*q2*q3^2*rx*ry - 18*Izz*mie*q1*q2^2*q3*rx*ry + 18*Izz*mie*q0*q1*q2^2*rx*rz + 18*Izz*mie*q0*q1*q3^2*rx*rz + 18*Izz*mie*q0^2*q2*q3*rx*rz + 18*Izz*mie*q1^2*q2*q3*rx*rz))/(Ixx*r_norm^5*(q0^2 + q1^2 + q2^2 + q3^2)^3);
                (6*Ixx*mie*q3^3*rx^2 - 6*Ixx*mie*q3^3*rz^2 - 6*Izz*mie*q3^3*rx^2 + 6*Izz*mie*q3^3*rz^2 + 6*Ixx*mie*q0^2*q3*rx^2 - 18*Ixx*mie*q1^2*q3*rx^2 - 6*Ixx*mie*q2^2*q3*rx^2 - 12*Ixx*mie*q0^2*q3*ry^2 + 12*Ixx*mie*q2^2*q3*ry^2 + 6*Ixx*mie*q0^2*q3*rz^2 + 18*Ixx*mie*q1^2*q3*rz^2 - 6*Ixx*mie*q2^2*q3*rz^2 - 6*Izz*mie*q0^2*q3*rx^2 + 18*Izz*mie*q1^2*q3*rx^2 + 6*Izz*mie*q2^2*q3*rx^2 + 12*Izz*mie*q0^2*q3*ry^2 - 12*Izz*mie*q2^2*q3*ry^2 - 6*Izz*mie*q0^2*q3*rz^2 - 18*Izz*mie*q1^2*q3*rz^2 + 6*Izz*mie*q2^2*q3*rz^2 - 4*Ixx*q1^3*r_norm^5*wx*wz + 4*Izz*q1^3*r_norm^5*wx*wz - 6*Ixx*mie*q2^3*rx*ry + 12*Ixx*mie*q1^3*rx*rz - 6*Ixx*mie*q0^3*ry*rz + 6*Izz*mie*q2^3*rx*ry - 12*Izz*mie*q1^3*rx*rz + 6*Izz*mie*q0^3*ry*rz - 12*Ixx*mie*q0*q1*q2*rx^2 + 24*Ixx*mie*q0*q1*q2*ry^2 - 12*Ixx*mie*q0*q1*q2*rz^2 + 12*Izz*mie*q0*q1*q2*rx^2 - 24*Izz*mie*q0*q1*q2*ry^2 + 12*Izz*mie*q0*q1*q2*rz^2 + 18*Ixx*mie*q0^2*q2*rx*ry - 18*Ixx*mie*q1^2*q2*rx*ry + 18*Ixx*mie*q2*q3^2*rx*ry - 36*Ixx*mie*q1*q3^2*rx*rz - 18*Ixx*mie*q0*q1^2*ry*rz + 18*Ixx*mie*q0*q2^2*ry*rz + 18*Ixx*mie*q0*q3^2*ry*rz - 18*Izz*mie*q0^2*q2*rx*ry + 18*Izz*mie*q1^2*q2*rx*ry - 18*Izz*mie*q2*q3^2*rx*ry + 36*Izz*mie*q1*q3^2*rx*rz + 18*Izz*mie*q0*q1^2*ry*rz - 18*Izz*mie*q0*q2^2*ry*rz - 18*Izz*mie*q0*q3^2*ry*rz - 4*Ixx*q0^2*q1*r_norm^5*wx*wz - 4*Ixx*q1*q2^2*r_norm^5*wx*wz - 4*Ixx*q1*q3^2*r_norm^5*wx*wz + 4*Izz*q0^2*q1*r_norm^5*wx*wz + 4*Izz*q1*q2^2*r_norm^5*wx*wz + 4*Izz*q1*q3^2*r_norm^5*wx*wz + 36*Ixx*mie*q0*q1*q3*rx*ry - 36*Ixx*mie*q1*q2*q3*ry*rz - 36*Izz*mie*q0*q1*q3*rx*ry + 36*Izz*mie*q1*q2*q3*ry*rz)/(Iyy*r_norm^5*(q0^2 + q1^2 + q2^2 + q3^2)^2) + (4*q1*(6*Ixx*mie*q0*q2^3*rx^2 - 6*Ixx*mie*q0^3*q2*rx^2 - 6*Ixx*mie*q1*q3^3*rx^2 + 6*Ixx*mie*q1^3*q3*rx^2 - 6*Ixx*mie*q0*q2^3*rz^2 + 6*Ixx*mie*q0^3*q2*rz^2 + 6*Ixx*mie*q1*q3^3*rz^2 - 6*Ixx*mie*q1^3*q3*rz^2 - 6*Izz*mie*q0*q2^3*rx^2 + 6*Izz*mie*q0^3*q2*rx^2 + 6*Izz*mie*q1*q3^3*rx^2 - 6*Izz*mie*q1^3*q3*rx^2 + 6*Izz*mie*q0*q2^3*rz^2 - 6*Izz*mie*q0^3*q2*rz^2 - 6*Izz*mie*q1*q3^3*rz^2 + 6*Izz*mie*q1^3*q3*rz^2 + Ixx*q0^4*r_norm^5*wx*wz + Ixx*q1^4*r_norm^5*wx*wz + Ixx*q2^4*r_norm^5*wx*wz + Ixx*q3^4*r_norm^5*wx*wz - Izz*q0^4*r_norm^5*wx*wz - Izz*q1^4*r_norm^5*wx*wz - Izz*q2^4*r_norm^5*wx*wz - Izz*q3^4*r_norm^5*wx*wz + 3*Ixx*mie*q0^4*rx*rz - 3*Ixx*mie*q1^4*rx*rz + 3*Ixx*mie*q2^4*rx*rz - 3*Ixx*mie*q3^4*rx*rz - 3*Izz*mie*q0^4*rx*rz + 3*Izz*mie*q1^4*rx*rz - 3*Izz*mie*q2^4*rx*rz + 3*Izz*mie*q3^4*rx*rz + 2*Ixx*q0^2*q1^2*r_norm^5*wx*wz + 2*Ixx*q0^2*q2^2*r_norm^5*wx*wz + 2*Ixx*q0^2*q3^2*r_norm^5*wx*wz + 2*Ixx*q1^2*q2^2*r_norm^5*wx*wz + 2*Ixx*q1^2*q3^2*r_norm^5*wx*wz + 2*Ixx*q2^2*q3^2*r_norm^5*wx*wz - 2*Izz*q0^2*q1^2*r_norm^5*wx*wz - 2*Izz*q0^2*q2^2*r_norm^5*wx*wz - 2*Izz*q0^2*q3^2*r_norm^5*wx*wz - 2*Izz*q1^2*q2^2*r_norm^5*wx*wz - 2*Izz*q1^2*q3^2*r_norm^5*wx*wz - 2*Izz*q2^2*q3^2*r_norm^5*wx*wz + 6*Ixx*mie*q0*q3^3*rx*ry + 6*Ixx*mie*q1*q2^3*rx*ry + 6*Ixx*mie*q0^3*q3*rx*ry + 6*Ixx*mie*q1^3*q2*rx*ry + 6*Ixx*mie*q0*q1^3*ry*rz + 6*Ixx*mie*q0^3*q1*ry*rz - 6*Ixx*mie*q2*q3^3*ry*rz - 6*Ixx*mie*q2^3*q3*ry*rz - 6*Izz*mie*q0*q3^3*rx*ry - 6*Izz*mie*q1*q2^3*rx*ry - 6*Izz*mie*q0^3*q3*rx*ry - 6*Izz*mie*q1^3*q2*rx*ry - 6*Izz*mie*q0*q1^3*ry*rz - 6*Izz*mie*q0^3*q1*ry*rz + 6*Izz*mie*q2*q3^3*ry*rz + 6*Izz*mie*q2^3*q3*ry*rz + 6*Ixx*mie*q0*q1^2*q2*rx^2 - 6*Ixx*mie*q0^2*q1*q3*rx^2 - 6*Ixx*mie*q0*q2*q3^2*rx^2 + 6*Ixx*mie*q1*q2^2*q3*rx^2 - 12*Ixx*mie*q0*q1^2*q2*ry^2 + 12*Ixx*mie*q0^2*q1*q3*ry^2 + 12*Ixx*mie*q0*q2*q3^2*ry^2 - 12*Ixx*mie*q1*q2^2*q3*ry^2 + 6*Ixx*mie*q0*q1^2*q2*rz^2 - 6*Ixx*mie*q0^2*q1*q3*rz^2 - 6*Ixx*mie*q0*q2*q3^2*rz^2 + 6*Ixx*mie*q1*q2^2*q3*rz^2 - 6*Izz*mie*q0*q1^2*q2*rx^2 + 6*Izz*mie*q0^2*q1*q3*rx^2 + 6*Izz*mie*q0*q2*q3^2*rx^2 - 6*Izz*mie*q1*q2^2*q3*rx^2 + 12*Izz*mie*q0*q1^2*q2*ry^2 - 12*Izz*mie*q0^2*q1*q3*ry^2 - 12*Izz*mie*q0*q2*q3^2*ry^2 + 12*Izz*mie*q1*q2^2*q3*ry^2 - 6*Izz*mie*q0*q1^2*q2*rz^2 + 6*Izz*mie*q0^2*q1*q3*rz^2 + 6*Izz*mie*q0*q2*q3^2*rz^2 - 6*Izz*mie*q1*q2^2*q3*rz^2 - 18*Ixx*mie*q0^2*q2^2*rx*rz + 18*Ixx*mie*q1^2*q3^2*rx*rz + 18*Izz*mie*q0^2*q2^2*rx*rz - 18*Izz*mie*q1^2*q3^2*rx*rz - 18*Ixx*mie*q0^2*q1*q2*rx*ry - 18*Ixx*mie*q0*q1^2*q3*rx*ry - 18*Ixx*mie*q0*q2^2*q3*rx*ry - 18*Ixx*mie*q1*q2*q3^2*rx*ry - 18*Ixx*mie*q0*q1*q2^2*ry*rz - 18*Ixx*mie*q0*q1*q3^2*ry*rz + 18*Ixx*mie*q0^2*q2*q3*ry*rz + 18*Ixx*mie*q1^2*q2*q3*ry*rz + 18*Izz*mie*q0^2*q1*q2*rx*ry + 18*Izz*mie*q0*q1^2*q3*rx*ry + 18*Izz*mie*q0*q2^2*q3*rx*ry + 18*Izz*mie*q1*q2*q3^2*rx*ry + 18*Izz*mie*q0*q1*q2^2*ry*rz + 18*Izz*mie*q0*q1*q3^2*ry*rz - 18*Izz*mie*q0^2*q2*q3*ry*rz - 18*Izz*mie*q1^2*q2*q3*ry*rz))/(Iyy*r_norm^5*(q0^2 + q1^2 + q2^2 + q3^2)^3);
                - (6*Ixx*mie*q0^3*rx^2 - 6*Ixx*mie*q0^3*ry^2 - 6*Iyy*mie*q0^3*rx^2 + 6*Iyy*mie*q0^3*ry^2 - 18*Ixx*mie*q0*q1^2*rx^2 - 6*Ixx*mie*q0*q2^2*rx^2 + 6*Ixx*mie*q0*q3^2*rx^2 + 18*Ixx*mie*q0*q1^2*ry^2 - 6*Ixx*mie*q0*q2^2*ry^2 + 6*Ixx*mie*q0*q3^2*ry^2 + 18*Iyy*mie*q0*q1^2*rx^2 + 6*Iyy*mie*q0*q2^2*rx^2 - 6*Iyy*mie*q0*q3^2*rx^2 + 12*Ixx*mie*q0*q2^2*rz^2 - 12*Ixx*mie*q0*q3^2*rz^2 - 18*Iyy*mie*q0*q1^2*ry^2 + 6*Iyy*mie*q0*q2^2*ry^2 - 6*Iyy*mie*q0*q3^2*ry^2 - 12*Iyy*mie*q0*q2^2*rz^2 + 12*Iyy*mie*q0*q3^2*rz^2 - 4*Ixx*q1^3*r_norm^5*wx*wy + 4*Iyy*q1^3*r_norm^5*wx*wy - 12*Ixx*mie*q1^3*rx*ry - 6*Ixx*mie*q2^3*rx*rz + 12*Iyy*mie*q1^3*rx*ry - 6*Ixx*mie*q3^3*ry*rz + 6*Iyy*mie*q2^3*rx*rz + 6*Iyy*mie*q3^3*ry*rz + 12*Ixx*mie*q1*q2*q3*rx^2 + 12*Ixx*mie*q1*q2*q3*ry^2 - 12*Iyy*mie*q1*q2*q3*rx^2 - 24*Ixx*mie*q1*q2*q3*rz^2 - 12*Iyy*mie*q1*q2*q3*ry^2 + 24*Iyy*mie*q1*q2*q3*rz^2 + 36*Ixx*mie*q0^2*q1*rx*ry + 18*Ixx*mie*q0^2*q2*rx*rz - 18*Ixx*mie*q1^2*q2*rx*rz + 18*Ixx*mie*q2*q3^2*rx*rz - 36*Iyy*mie*q0^2*q1*rx*ry + 18*Ixx*mie*q0^2*q3*ry*rz - 18*Ixx*mie*q1^2*q3*ry*rz + 18*Ixx*mie*q2^2*q3*ry*rz - 18*Iyy*mie*q0^2*q2*rx*rz + 18*Iyy*mie*q1^2*q2*rx*rz - 18*Iyy*mie*q2*q3^2*rx*rz - 18*Iyy*mie*q0^2*q3*ry*rz + 18*Iyy*mie*q1^2*q3*ry*rz - 18*Iyy*mie*q2^2*q3*ry*rz - 4*Ixx*q0^2*q1*r_norm^5*wx*wy - 4*Ixx*q1*q2^2*r_norm^5*wx*wy - 4*Ixx*q1*q3^2*r_norm^5*wx*wy + 4*Iyy*q0^2*q1*r_norm^5*wx*wy + 4*Iyy*q1*q2^2*r_norm^5*wx*wy + 4*Iyy*q1*q3^2*r_norm^5*wx*wy - 36*Ixx*mie*q0*q1*q3*rx*rz + 36*Ixx*mie*q0*q1*q2*ry*rz + 36*Iyy*mie*q0*q1*q3*rx*rz - 36*Iyy*mie*q0*q1*q2*ry*rz)/(Izz*r_norm^5*(q0^2 + q1^2 + q2^2 + q3^2)^2) - (4*q1*(6*Ixx*mie*q0*q1^3*rx^2 - 6*Ixx*mie*q0^3*q1*rx^2 + 6*Ixx*mie*q2*q3^3*rx^2 - 6*Ixx*mie*q2^3*q3*rx^2 - 6*Ixx*mie*q0*q1^3*ry^2 + 6*Ixx*mie*q0^3*q1*ry^2 - 6*Ixx*mie*q2*q3^3*ry^2 + 6*Ixx*mie*q2^3*q3*ry^2 - 6*Iyy*mie*q0*q1^3*rx^2 + 6*Iyy*mie*q0^3*q1*rx^2 - 6*Iyy*mie*q2*q3^3*rx^2 + 6*Iyy*mie*q2^3*q3*rx^2 + 6*Iyy*mie*q0*q1^3*ry^2 - 6*Iyy*mie*q0^3*q1*ry^2 + 6*Iyy*mie*q2*q3^3*ry^2 - 6*Iyy*mie*q2^3*q3*ry^2 + Ixx*q0^4*r_norm^5*wx*wy + Ixx*q1^4*r_norm^5*wx*wy + Ixx*q2^4*r_norm^5*wx*wy + Ixx*q3^4*r_norm^5*wx*wy - Iyy*q0^4*r_norm^5*wx*wy - Iyy*q1^4*r_norm^5*wx*wy - Iyy*q2^4*r_norm^5*wx*wy - Iyy*q3^4*r_norm^5*wx*wy + 3*Ixx*mie*q0^4*rx*ry + 3*Ixx*mie*q1^4*rx*ry - 3*Ixx*mie*q2^4*rx*ry - 3*Ixx*mie*q3^4*rx*ry - 3*Iyy*mie*q0^4*rx*ry - 3*Iyy*mie*q1^4*rx*ry + 3*Iyy*mie*q2^4*rx*ry + 3*Iyy*mie*q3^4*rx*ry + 2*Ixx*q0^2*q1^2*r_norm^5*wx*wy + 2*Ixx*q0^2*q2^2*r_norm^5*wx*wy + 2*Ixx*q0^2*q3^2*r_norm^5*wx*wy + 2*Ixx*q1^2*q2^2*r_norm^5*wx*wy + 2*Ixx*q1^2*q3^2*r_norm^5*wx*wy + 2*Ixx*q2^2*q3^2*r_norm^5*wx*wy - 2*Iyy*q0^2*q1^2*r_norm^5*wx*wy - 2*Iyy*q0^2*q2^2*r_norm^5*wx*wy - 2*Iyy*q0^2*q3^2*r_norm^5*wx*wy - 2*Iyy*q1^2*q2^2*r_norm^5*wx*wy - 2*Iyy*q1^2*q3^2*r_norm^5*wx*wy - 2*Iyy*q2^2*q3^2*r_norm^5*wx*wy - 6*Ixx*mie*q0*q3^3*rx*rz + 6*Ixx*mie*q1*q2^3*rx*rz - 6*Ixx*mie*q0^3*q3*rx*rz + 6*Ixx*mie*q1^3*q2*rx*rz + 6*Ixx*mie*q0*q2^3*ry*rz + 6*Ixx*mie*q0^3*q2*ry*rz + 6*Ixx*mie*q1*q3^3*ry*rz + 6*Ixx*mie*q1^3*q3*ry*rz + 6*Iyy*mie*q0*q3^3*rx*rz - 6*Iyy*mie*q1*q2^3*rx*rz + 6*Iyy*mie*q0^3*q3*rx*rz - 6*Iyy*mie*q1^3*q2*rx*rz - 6*Iyy*mie*q0*q2^3*ry*rz - 6*Iyy*mie*q0^3*q2*ry*rz - 6*Iyy*mie*q1*q3^3*ry*rz - 6*Iyy*mie*q1^3*q3*ry*rz + 6*Ixx*mie*q0*q1*q2^2*rx^2 - 6*Ixx*mie*q0*q1*q3^2*rx^2 + 6*Ixx*mie*q0^2*q2*q3*rx^2 - 6*Ixx*mie*q1^2*q2*q3*rx^2 + 6*Ixx*mie*q0*q1*q2^2*ry^2 - 6*Ixx*mie*q0*q1*q3^2*ry^2 + 6*Ixx*mie*q0^2*q2*q3*ry^2 - 6*Ixx*mie*q1^2*q2*q3*ry^2 - 6*Iyy*mie*q0*q1*q2^2*rx^2 + 6*Iyy*mie*q0*q1*q3^2*rx^2 - 6*Iyy*mie*q0^2*q2*q3*rx^2 + 6*Iyy*mie*q1^2*q2*q3*rx^2 - 12*Ixx*mie*q0*q1*q2^2*rz^2 + 12*Ixx*mie*q0*q1*q3^2*rz^2 - 12*Ixx*mie*q0^2*q2*q3*rz^2 + 12*Ixx*mie*q1^2*q2*q3*rz^2 - 6*Iyy*mie*q0*q1*q2^2*ry^2 + 6*Iyy*mie*q0*q1*q3^2*ry^2 - 6*Iyy*mie*q0^2*q2*q3*ry^2 + 6*Iyy*mie*q1^2*q2*q3*ry^2 + 12*Iyy*mie*q0*q1*q2^2*rz^2 - 12*Iyy*mie*q0*q1*q3^2*rz^2 + 12*Iyy*mie*q0^2*q2*q3*rz^2 - 12*Iyy*mie*q1^2*q2*q3*rz^2 - 18*Ixx*mie*q0^2*q1^2*rx*ry + 18*Ixx*mie*q2^2*q3^2*rx*ry + 18*Iyy*mie*q0^2*q1^2*rx*ry - 18*Iyy*mie*q2^2*q3^2*rx*ry - 18*Ixx*mie*q0^2*q1*q2*rx*rz + 18*Ixx*mie*q0*q1^2*q3*rx*rz + 18*Ixx*mie*q0*q2^2*q3*rx*rz - 18*Ixx*mie*q1*q2*q3^2*rx*rz - 18*Ixx*mie*q0*q1^2*q2*ry*rz - 18*Ixx*mie*q0^2*q1*q3*ry*rz - 18*Ixx*mie*q0*q2*q3^2*ry*rz - 18*Ixx*mie*q1*q2^2*q3*ry*rz + 18*Iyy*mie*q0^2*q1*q2*rx*rz - 18*Iyy*mie*q0*q1^2*q3*rx*rz - 18*Iyy*mie*q0*q2^2*q3*rx*rz + 18*Iyy*mie*q1*q2*q3^2*rx*rz + 18*Iyy*mie*q0*q1^2*q2*ry*rz + 18*Iyy*mie*q0^2*q1*q3*ry*rz + 18*Iyy*mie*q0*q2*q3^2*ry*rz + 18*Iyy*mie*q1*q2^2*q3*ry*rz))/(Izz*r_norm^5*(q0^2 + q1^2 + q2^2 + q3^2)^3)];
            
    A(5:7,3) = [- (6*Iyy*mie*q1^3*ry^2 - 6*Iyy*mie*q1^3*rz^2 - 6*Izz*mie*q1^3*ry^2 + 6*Izz*mie*q1^3*rz^2 + 12*Iyy*mie*q0^2*q1*rx^2 - 12*Iyy*mie*q1*q3^2*rx^2 - 6*Iyy*mie*q0^2*q1*ry^2 - 18*Iyy*mie*q1*q2^2*ry^2 + 6*Iyy*mie*q1*q3^2*ry^2 - 12*Izz*mie*q0^2*q1*rx^2 + 12*Izz*mie*q1*q3^2*rx^2 - 6*Iyy*mie*q0^2*q1*rz^2 + 18*Iyy*mie*q1*q2^2*rz^2 + 6*Iyy*mie*q1*q3^2*rz^2 + 6*Izz*mie*q0^2*q1*ry^2 + 18*Izz*mie*q1*q2^2*ry^2 - 6*Izz*mie*q1*q3^2*ry^2 + 6*Izz*mie*q0^2*q1*rz^2 - 18*Izz*mie*q1*q2^2*rz^2 - 6*Izz*mie*q1*q3^2*rz^2 - 4*Iyy*q2^3*r_norm^5*wy*wz + 4*Izz*q2^3*r_norm^5*wy*wz - 6*Iyy*mie*q0^3*rx*ry - 6*Iyy*mie*q3^3*rx*rz + 6*Izz*mie*q0^3*rx*ry - 12*Iyy*mie*q2^3*ry*rz + 6*Izz*mie*q3^3*rx*rz + 12*Izz*mie*q2^3*ry*rz - 24*Iyy*mie*q0*q2*q3*rx^2 + 12*Iyy*mie*q0*q2*q3*ry^2 + 24*Izz*mie*q0*q2*q3*rx^2 + 12*Iyy*mie*q0*q2*q3*rz^2 - 12*Izz*mie*q0*q2*q3*ry^2 - 12*Izz*mie*q0*q2*q3*rz^2 + 18*Iyy*mie*q0*q1^2*rx*ry - 18*Iyy*mie*q0*q2^2*rx*ry + 18*Iyy*mie*q0*q3^2*rx*ry + 18*Iyy*mie*q0^2*q3*rx*rz + 18*Iyy*mie*q1^2*q3*rx*rz - 18*Iyy*mie*q2^2*q3*rx*rz - 18*Izz*mie*q0*q1^2*rx*ry + 18*Izz*mie*q0*q2^2*rx*ry - 18*Izz*mie*q0*q3^2*rx*ry + 36*Iyy*mie*q1^2*q2*ry*rz - 18*Izz*mie*q0^2*q3*rx*rz - 18*Izz*mie*q1^2*q3*rx*rz + 18*Izz*mie*q2^2*q3*rx*rz - 36*Izz*mie*q1^2*q2*ry*rz - 4*Iyy*q0^2*q2*r_norm^5*wy*wz - 4*Iyy*q1^2*q2*r_norm^5*wy*wz - 4*Iyy*q2*q3^2*r_norm^5*wy*wz + 4*Izz*q0^2*q2*r_norm^5*wy*wz + 4*Izz*q1^2*q2*r_norm^5*wy*wz + 4*Izz*q2*q3^2*r_norm^5*wy*wz - 36*Iyy*mie*q1*q2*q3*rx*ry + 36*Iyy*mie*q0*q1*q2*rx*rz + 36*Izz*mie*q1*q2*q3*rx*ry - 36*Izz*mie*q0*q1*q2*rx*rz)/(Ixx*r_norm^5*(q0^2 + q1^2 + q2^2 + q3^2)^2) - (4*q2*(6*Iyy*mie*q0*q3^3*ry^2 + 6*Iyy*mie*q1*q2^3*ry^2 - 6*Iyy*mie*q0^3*q3*ry^2 - 6*Iyy*mie*q1^3*q2*ry^2 - 6*Iyy*mie*q0*q3^3*rz^2 - 6*Iyy*mie*q1*q2^3*rz^2 + 6*Iyy*mie*q0^3*q3*rz^2 + 6*Iyy*mie*q1^3*q2*rz^2 - 6*Izz*mie*q0*q3^3*ry^2 - 6*Izz*mie*q1*q2^3*ry^2 + 6*Izz*mie*q0^3*q3*ry^2 + 6*Izz*mie*q1^3*q2*ry^2 + 6*Izz*mie*q0*q3^3*rz^2 + 6*Izz*mie*q1*q2^3*rz^2 - 6*Izz*mie*q0^3*q3*rz^2 - 6*Izz*mie*q1^3*q2*rz^2 + Iyy*q0^4*r_norm^5*wy*wz + Iyy*q1^4*r_norm^5*wy*wz + Iyy*q2^4*r_norm^5*wy*wz + Iyy*q3^4*r_norm^5*wy*wz - Izz*q0^4*r_norm^5*wy*wz - Izz*q1^4*r_norm^5*wy*wz - Izz*q2^4*r_norm^5*wy*wz - Izz*q3^4*r_norm^5*wy*wz - 3*Iyy*mie*q0^4*ry*rz + 3*Iyy*mie*q1^4*ry*rz + 3*Iyy*mie*q2^4*ry*rz - 3*Iyy*mie*q3^4*ry*rz + 3*Izz*mie*q0^4*ry*rz - 3*Izz*mie*q1^4*ry*rz - 3*Izz*mie*q2^4*ry*rz + 3*Izz*mie*q3^4*ry*rz + 2*Iyy*q0^2*q1^2*r_norm^5*wy*wz + 2*Iyy*q0^2*q2^2*r_norm^5*wy*wz + 2*Iyy*q0^2*q3^2*r_norm^5*wy*wz + 2*Iyy*q1^2*q2^2*r_norm^5*wy*wz + 2*Iyy*q1^2*q3^2*r_norm^5*wy*wz + 2*Iyy*q2^2*q3^2*r_norm^5*wy*wz - 2*Izz*q0^2*q1^2*r_norm^5*wy*wz - 2*Izz*q0^2*q2^2*r_norm^5*wy*wz - 2*Izz*q0^2*q3^2*r_norm^5*wy*wz - 2*Izz*q1^2*q2^2*r_norm^5*wy*wz - 2*Izz*q1^2*q3^2*r_norm^5*wy*wz - 2*Izz*q2^2*q3^2*r_norm^5*wy*wz + 6*Iyy*mie*q0*q2^3*rx*ry + 6*Iyy*mie*q0^3*q2*rx*ry - 6*Iyy*mie*q1*q3^3*rx*ry - 6*Iyy*mie*q1^3*q3*rx*ry + 6*Iyy*mie*q0*q1^3*rx*rz + 6*Iyy*mie*q0^3*q1*rx*rz + 6*Iyy*mie*q2*q3^3*rx*rz + 6*Iyy*mie*q2^3*q3*rx*rz - 6*Izz*mie*q0*q2^3*rx*ry - 6*Izz*mie*q0^3*q2*rx*ry + 6*Izz*mie*q1*q3^3*rx*ry + 6*Izz*mie*q1^3*q3*rx*ry - 6*Izz*mie*q0*q1^3*rx*rz - 6*Izz*mie*q0^3*q1*rx*rz - 6*Izz*mie*q2*q3^3*rx*rz - 6*Izz*mie*q2^3*q3*rx*rz - 12*Iyy*mie*q0^2*q1*q2*rx^2 - 12*Iyy*mie*q0*q1^2*q3*rx^2 + 12*Iyy*mie*q0*q2^2*q3*rx^2 + 12*Iyy*mie*q1*q2*q3^2*rx^2 + 6*Iyy*mie*q0^2*q1*q2*ry^2 + 6*Iyy*mie*q0*q1^2*q3*ry^2 - 6*Iyy*mie*q0*q2^2*q3*ry^2 - 6*Iyy*mie*q1*q2*q3^2*ry^2 + 12*Izz*mie*q0^2*q1*q2*rx^2 + 12*Izz*mie*q0*q1^2*q3*rx^2 - 12*Izz*mie*q0*q2^2*q3*rx^2 - 12*Izz*mie*q1*q2*q3^2*rx^2 + 6*Iyy*mie*q0^2*q1*q2*rz^2 + 6*Iyy*mie*q0*q1^2*q3*rz^2 - 6*Iyy*mie*q0*q2^2*q3*rz^2 - 6*Iyy*mie*q1*q2*q3^2*rz^2 - 6*Izz*mie*q0^2*q1*q2*ry^2 - 6*Izz*mie*q0*q1^2*q3*ry^2 + 6*Izz*mie*q0*q2^2*q3*ry^2 + 6*Izz*mie*q1*q2*q3^2*ry^2 - 6*Izz*mie*q0^2*q1*q2*rz^2 - 6*Izz*mie*q0*q1^2*q3*rz^2 + 6*Izz*mie*q0*q2^2*q3*rz^2 + 6*Izz*mie*q1*q2*q3^2*rz^2 + 18*Iyy*mie*q0^2*q3^2*ry*rz - 18*Iyy*mie*q1^2*q2^2*ry*rz - 18*Izz*mie*q0^2*q3^2*ry*rz + 18*Izz*mie*q1^2*q2^2*ry*rz - 18*Iyy*mie*q0*q1^2*q2*rx*ry + 18*Iyy*mie*q0^2*q1*q3*rx*ry - 18*Iyy*mie*q0*q2*q3^2*rx*ry + 18*Iyy*mie*q1*q2^2*q3*rx*ry - 18*Iyy*mie*q0*q1*q2^2*rx*rz - 18*Iyy*mie*q0*q1*q3^2*rx*rz - 18*Iyy*mie*q0^2*q2*q3*rx*rz - 18*Iyy*mie*q1^2*q2*q3*rx*rz + 18*Izz*mie*q0*q1^2*q2*rx*ry - 18*Izz*mie*q0^2*q1*q3*rx*ry + 18*Izz*mie*q0*q2*q3^2*rx*ry - 18*Izz*mie*q1*q2^2*q3*rx*ry + 18*Izz*mie*q0*q1*q2^2*rx*rz + 18*Izz*mie*q0*q1*q3^2*rx*rz + 18*Izz*mie*q0^2*q2*q3*rx*rz + 18*Izz*mie*q1^2*q2*q3*rx*rz))/(Ixx*r_norm^5*(q0^2 + q1^2 + q2^2 + q3^2)^3);
                (6*Ixx*mie*q0^3*rx^2 - 6*Ixx*mie*q0^3*rz^2 - 6*Izz*mie*q0^3*rx^2 + 6*Izz*mie*q0^3*rz^2 - 6*Ixx*mie*q0*q1^2*rx^2 - 18*Ixx*mie*q0*q2^2*rx^2 + 6*Ixx*mie*q0*q3^2*rx^2 + 12*Ixx*mie*q0*q1^2*ry^2 - 12*Ixx*mie*q0*q3^2*ry^2 - 6*Ixx*mie*q0*q1^2*rz^2 + 18*Ixx*mie*q0*q2^2*rz^2 + 6*Ixx*mie*q0*q3^2*rz^2 + 6*Izz*mie*q0*q1^2*rx^2 + 18*Izz*mie*q0*q2^2*rx^2 - 6*Izz*mie*q0*q3^2*rx^2 - 12*Izz*mie*q0*q1^2*ry^2 + 12*Izz*mie*q0*q3^2*ry^2 + 6*Izz*mie*q0*q1^2*rz^2 - 18*Izz*mie*q0*q2^2*rz^2 - 6*Izz*mie*q0*q3^2*rz^2 - 4*Ixx*q2^3*r_norm^5*wx*wz + 4*Izz*q2^3*r_norm^5*wx*wz - 6*Ixx*mie*q1^3*rx*ry - 12*Ixx*mie*q2^3*rx*rz + 6*Ixx*mie*q3^3*ry*rz + 6*Izz*mie*q1^3*rx*ry + 12*Izz*mie*q2^3*rx*rz - 6*Izz*mie*q3^3*ry*rz - 12*Ixx*mie*q1*q2*q3*rx^2 + 24*Ixx*mie*q1*q2*q3*ry^2 - 12*Ixx*mie*q1*q2*q3*rz^2 + 12*Izz*mie*q1*q2*q3*rx^2 - 24*Izz*mie*q1*q2*q3*ry^2 + 12*Izz*mie*q1*q2*q3*rz^2 + 18*Ixx*mie*q0^2*q1*rx*ry - 18*Ixx*mie*q1*q2^2*rx*ry + 18*Ixx*mie*q1*q3^2*rx*ry + 36*Ixx*mie*q0^2*q2*rx*rz - 18*Ixx*mie*q0^2*q3*ry*rz - 18*Ixx*mie*q1^2*q3*ry*rz + 18*Ixx*mie*q2^2*q3*ry*rz - 18*Izz*mie*q0^2*q1*rx*ry + 18*Izz*mie*q1*q2^2*rx*ry - 18*Izz*mie*q1*q3^2*rx*ry - 36*Izz*mie*q0^2*q2*rx*rz + 18*Izz*mie*q0^2*q3*ry*rz + 18*Izz*mie*q1^2*q3*ry*rz - 18*Izz*mie*q2^2*q3*ry*rz - 4*Ixx*q0^2*q2*r_norm^5*wx*wz - 4*Ixx*q1^2*q2*r_norm^5*wx*wz - 4*Ixx*q2*q3^2*r_norm^5*wx*wz + 4*Izz*q0^2*q2*r_norm^5*wx*wz + 4*Izz*q1^2*q2*r_norm^5*wx*wz + 4*Izz*q2*q3^2*r_norm^5*wx*wz + 36*Ixx*mie*q0*q2*q3*rx*ry + 36*Ixx*mie*q0*q1*q2*ry*rz - 36*Izz*mie*q0*q2*q3*rx*ry - 36*Izz*mie*q0*q1*q2*ry*rz)/(Iyy*r_norm^5*(q0^2 + q1^2 + q2^2 + q3^2)^2) + (4*q2*(6*Ixx*mie*q0*q2^3*rx^2 - 6*Ixx*mie*q0^3*q2*rx^2 - 6*Ixx*mie*q1*q3^3*rx^2 + 6*Ixx*mie*q1^3*q3*rx^2 - 6*Ixx*mie*q0*q2^3*rz^2 + 6*Ixx*mie*q0^3*q2*rz^2 + 6*Ixx*mie*q1*q3^3*rz^2 - 6*Ixx*mie*q1^3*q3*rz^2 - 6*Izz*mie*q0*q2^3*rx^2 + 6*Izz*mie*q0^3*q2*rx^2 + 6*Izz*mie*q1*q3^3*rx^2 - 6*Izz*mie*q1^3*q3*rx^2 + 6*Izz*mie*q0*q2^3*rz^2 - 6*Izz*mie*q0^3*q2*rz^2 - 6*Izz*mie*q1*q3^3*rz^2 + 6*Izz*mie*q1^3*q3*rz^2 + Ixx*q0^4*r_norm^5*wx*wz + Ixx*q1^4*r_norm^5*wx*wz + Ixx*q2^4*r_norm^5*wx*wz + Ixx*q3^4*r_norm^5*wx*wz - Izz*q0^4*r_norm^5*wx*wz - Izz*q1^4*r_norm^5*wx*wz - Izz*q2^4*r_norm^5*wx*wz - Izz*q3^4*r_norm^5*wx*wz + 3*Ixx*mie*q0^4*rx*rz - 3*Ixx*mie*q1^4*rx*rz + 3*Ixx*mie*q2^4*rx*rz - 3*Ixx*mie*q3^4*rx*rz - 3*Izz*mie*q0^4*rx*rz + 3*Izz*mie*q1^4*rx*rz - 3*Izz*mie*q2^4*rx*rz + 3*Izz*mie*q3^4*rx*rz + 2*Ixx*q0^2*q1^2*r_norm^5*wx*wz + 2*Ixx*q0^2*q2^2*r_norm^5*wx*wz + 2*Ixx*q0^2*q3^2*r_norm^5*wx*wz + 2*Ixx*q1^2*q2^2*r_norm^5*wx*wz + 2*Ixx*q1^2*q3^2*r_norm^5*wx*wz + 2*Ixx*q2^2*q3^2*r_norm^5*wx*wz - 2*Izz*q0^2*q1^2*r_norm^5*wx*wz - 2*Izz*q0^2*q2^2*r_norm^5*wx*wz - 2*Izz*q0^2*q3^2*r_norm^5*wx*wz - 2*Izz*q1^2*q2^2*r_norm^5*wx*wz - 2*Izz*q1^2*q3^2*r_norm^5*wx*wz - 2*Izz*q2^2*q3^2*r_norm^5*wx*wz + 6*Ixx*mie*q0*q3^3*rx*ry + 6*Ixx*mie*q1*q2^3*rx*ry + 6*Ixx*mie*q0^3*q3*rx*ry + 6*Ixx*mie*q1^3*q2*rx*ry + 6*Ixx*mie*q0*q1^3*ry*rz + 6*Ixx*mie*q0^3*q1*ry*rz - 6*Ixx*mie*q2*q3^3*ry*rz - 6*Ixx*mie*q2^3*q3*ry*rz - 6*Izz*mie*q0*q3^3*rx*ry - 6*Izz*mie*q1*q2^3*rx*ry - 6*Izz*mie*q0^3*q3*rx*ry - 6*Izz*mie*q1^3*q2*rx*ry - 6*Izz*mie*q0*q1^3*ry*rz - 6*Izz*mie*q0^3*q1*ry*rz + 6*Izz*mie*q2*q3^3*ry*rz + 6*Izz*mie*q2^3*q3*ry*rz + 6*Ixx*mie*q0*q1^2*q2*rx^2 - 6*Ixx*mie*q0^2*q1*q3*rx^2 - 6*Ixx*mie*q0*q2*q3^2*rx^2 + 6*Ixx*mie*q1*q2^2*q3*rx^2 - 12*Ixx*mie*q0*q1^2*q2*ry^2 + 12*Ixx*mie*q0^2*q1*q3*ry^2 + 12*Ixx*mie*q0*q2*q3^2*ry^2 - 12*Ixx*mie*q1*q2^2*q3*ry^2 + 6*Ixx*mie*q0*q1^2*q2*rz^2 - 6*Ixx*mie*q0^2*q1*q3*rz^2 - 6*Ixx*mie*q0*q2*q3^2*rz^2 + 6*Ixx*mie*q1*q2^2*q3*rz^2 - 6*Izz*mie*q0*q1^2*q2*rx^2 + 6*Izz*mie*q0^2*q1*q3*rx^2 + 6*Izz*mie*q0*q2*q3^2*rx^2 - 6*Izz*mie*q1*q2^2*q3*rx^2 + 12*Izz*mie*q0*q1^2*q2*ry^2 - 12*Izz*mie*q0^2*q1*q3*ry^2 - 12*Izz*mie*q0*q2*q3^2*ry^2 + 12*Izz*mie*q1*q2^2*q3*ry^2 - 6*Izz*mie*q0*q1^2*q2*rz^2 + 6*Izz*mie*q0^2*q1*q3*rz^2 + 6*Izz*mie*q0*q2*q3^2*rz^2 - 6*Izz*mie*q1*q2^2*q3*rz^2 - 18*Ixx*mie*q0^2*q2^2*rx*rz + 18*Ixx*mie*q1^2*q3^2*rx*rz + 18*Izz*mie*q0^2*q2^2*rx*rz - 18*Izz*mie*q1^2*q3^2*rx*rz - 18*Ixx*mie*q0^2*q1*q2*rx*ry - 18*Ixx*mie*q0*q1^2*q3*rx*ry - 18*Ixx*mie*q0*q2^2*q3*rx*ry - 18*Ixx*mie*q1*q2*q3^2*rx*ry - 18*Ixx*mie*q0*q1*q2^2*ry*rz - 18*Ixx*mie*q0*q1*q3^2*ry*rz + 18*Ixx*mie*q0^2*q2*q3*ry*rz + 18*Ixx*mie*q1^2*q2*q3*ry*rz + 18*Izz*mie*q0^2*q1*q2*rx*ry + 18*Izz*mie*q0*q1^2*q3*rx*ry + 18*Izz*mie*q0*q2^2*q3*rx*ry + 18*Izz*mie*q1*q2*q3^2*rx*ry + 18*Izz*mie*q0*q1*q2^2*ry*rz + 18*Izz*mie*q0*q1*q3^2*ry*rz - 18*Izz*mie*q0^2*q2*q3*ry*rz - 18*Izz*mie*q1^2*q2*q3*ry*rz))/(Iyy*r_norm^5*(q0^2 + q1^2 + q2^2 + q3^2)^3);
                (6*Ixx*mie*q3^3*rx^2 - 6*Ixx*mie*q3^3*ry^2 - 6*Iyy*mie*q3^3*rx^2 + 6*Iyy*mie*q3^3*ry^2 + 6*Ixx*mie*q0^2*q3*rx^2 - 6*Ixx*mie*q1^2*q3*rx^2 - 18*Ixx*mie*q2^2*q3*rx^2 + 6*Ixx*mie*q0^2*q3*ry^2 - 6*Ixx*mie*q1^2*q3*ry^2 + 18*Ixx*mie*q2^2*q3*ry^2 - 6*Iyy*mie*q0^2*q3*rx^2 + 6*Iyy*mie*q1^2*q3*rx^2 + 18*Iyy*mie*q2^2*q3*rx^2 - 12*Ixx*mie*q0^2*q3*rz^2 + 12*Ixx*mie*q1^2*q3*rz^2 - 6*Iyy*mie*q0^2*q3*ry^2 + 6*Iyy*mie*q1^2*q3*ry^2 - 18*Iyy*mie*q2^2*q3*ry^2 + 12*Iyy*mie*q0^2*q3*rz^2 - 12*Iyy*mie*q1^2*q3*rz^2 + 4*Ixx*q2^3*r_norm^5*wx*wy - 4*Iyy*q2^3*r_norm^5*wx*wy - 12*Ixx*mie*q2^3*rx*ry + 6*Ixx*mie*q1^3*rx*rz + 12*Iyy*mie*q2^3*rx*ry + 6*Ixx*mie*q0^3*ry*rz - 6*Iyy*mie*q1^3*rx*rz - 6*Iyy*mie*q0^3*ry*rz + 12*Ixx*mie*q0*q1*q2*rx^2 + 12*Ixx*mie*q0*q1*q2*ry^2 - 12*Iyy*mie*q0*q1*q2*rx^2 - 24*Ixx*mie*q0*q1*q2*rz^2 - 12*Iyy*mie*q0*q1*q2*ry^2 + 24*Iyy*mie*q0*q1*q2*rz^2 + 36*Ixx*mie*q2*q3^2*rx*ry - 18*Ixx*mie*q0^2*q1*rx*rz + 18*Ixx*mie*q1*q2^2*rx*rz - 18*Ixx*mie*q1*q3^2*rx*rz - 36*Iyy*mie*q2*q3^2*rx*ry - 18*Ixx*mie*q0*q1^2*ry*rz + 18*Ixx*mie*q0*q2^2*ry*rz - 18*Ixx*mie*q0*q3^2*ry*rz + 18*Iyy*mie*q0^2*q1*rx*rz - 18*Iyy*mie*q1*q2^2*rx*rz + 18*Iyy*mie*q1*q3^2*rx*rz + 18*Iyy*mie*q0*q1^2*ry*rz - 18*Iyy*mie*q0*q2^2*ry*rz + 18*Iyy*mie*q0*q3^2*ry*rz + 4*Ixx*q0^2*q2*r_norm^5*wx*wy + 4*Ixx*q1^2*q2*r_norm^5*wx*wy + 4*Ixx*q2*q3^2*r_norm^5*wx*wy - 4*Iyy*q0^2*q2*r_norm^5*wx*wy - 4*Iyy*q1^2*q2*r_norm^5*wx*wy - 4*Iyy*q2*q3^2*r_norm^5*wx*wy + 36*Ixx*mie*q0*q2*q3*rx*rz - 36*Ixx*mie*q1*q2*q3*ry*rz - 36*Iyy*mie*q0*q2*q3*rx*rz + 36*Iyy*mie*q1*q2*q3*ry*rz)/(Izz*r_norm^5*(q0^2 + q1^2 + q2^2 + q3^2)^2) - (4*q2*(6*Ixx*mie*q0*q1^3*rx^2 - 6*Ixx*mie*q0^3*q1*rx^2 + 6*Ixx*mie*q2*q3^3*rx^2 - 6*Ixx*mie*q2^3*q3*rx^2 - 6*Ixx*mie*q0*q1^3*ry^2 + 6*Ixx*mie*q0^3*q1*ry^2 - 6*Ixx*mie*q2*q3^3*ry^2 + 6*Ixx*mie*q2^3*q3*ry^2 - 6*Iyy*mie*q0*q1^3*rx^2 + 6*Iyy*mie*q0^3*q1*rx^2 - 6*Iyy*mie*q2*q3^3*rx^2 + 6*Iyy*mie*q2^3*q3*rx^2 + 6*Iyy*mie*q0*q1^3*ry^2 - 6*Iyy*mie*q0^3*q1*ry^2 + 6*Iyy*mie*q2*q3^3*ry^2 - 6*Iyy*mie*q2^3*q3*ry^2 + Ixx*q0^4*r_norm^5*wx*wy + Ixx*q1^4*r_norm^5*wx*wy + Ixx*q2^4*r_norm^5*wx*wy + Ixx*q3^4*r_norm^5*wx*wy - Iyy*q0^4*r_norm^5*wx*wy - Iyy*q1^4*r_norm^5*wx*wy - Iyy*q2^4*r_norm^5*wx*wy - Iyy*q3^4*r_norm^5*wx*wy + 3*Ixx*mie*q0^4*rx*ry + 3*Ixx*mie*q1^4*rx*ry - 3*Ixx*mie*q2^4*rx*ry - 3*Ixx*mie*q3^4*rx*ry - 3*Iyy*mie*q0^4*rx*ry - 3*Iyy*mie*q1^4*rx*ry + 3*Iyy*mie*q2^4*rx*ry + 3*Iyy*mie*q3^4*rx*ry + 2*Ixx*q0^2*q1^2*r_norm^5*wx*wy + 2*Ixx*q0^2*q2^2*r_norm^5*wx*wy + 2*Ixx*q0^2*q3^2*r_norm^5*wx*wy + 2*Ixx*q1^2*q2^2*r_norm^5*wx*wy + 2*Ixx*q1^2*q3^2*r_norm^5*wx*wy + 2*Ixx*q2^2*q3^2*r_norm^5*wx*wy - 2*Iyy*q0^2*q1^2*r_norm^5*wx*wy - 2*Iyy*q0^2*q2^2*r_norm^5*wx*wy - 2*Iyy*q0^2*q3^2*r_norm^5*wx*wy - 2*Iyy*q1^2*q2^2*r_norm^5*wx*wy - 2*Iyy*q1^2*q3^2*r_norm^5*wx*wy - 2*Iyy*q2^2*q3^2*r_norm^5*wx*wy - 6*Ixx*mie*q0*q3^3*rx*rz + 6*Ixx*mie*q1*q2^3*rx*rz - 6*Ixx*mie*q0^3*q3*rx*rz + 6*Ixx*mie*q1^3*q2*rx*rz + 6*Ixx*mie*q0*q2^3*ry*rz + 6*Ixx*mie*q0^3*q2*ry*rz + 6*Ixx*mie*q1*q3^3*ry*rz + 6*Ixx*mie*q1^3*q3*ry*rz + 6*Iyy*mie*q0*q3^3*rx*rz - 6*Iyy*mie*q1*q2^3*rx*rz + 6*Iyy*mie*q0^3*q3*rx*rz - 6*Iyy*mie*q1^3*q2*rx*rz - 6*Iyy*mie*q0*q2^3*ry*rz - 6*Iyy*mie*q0^3*q2*ry*rz - 6*Iyy*mie*q1*q3^3*ry*rz - 6*Iyy*mie*q1^3*q3*ry*rz + 6*Ixx*mie*q0*q1*q2^2*rx^2 - 6*Ixx*mie*q0*q1*q3^2*rx^2 + 6*Ixx*mie*q0^2*q2*q3*rx^2 - 6*Ixx*mie*q1^2*q2*q3*rx^2 + 6*Ixx*mie*q0*q1*q2^2*ry^2 - 6*Ixx*mie*q0*q1*q3^2*ry^2 + 6*Ixx*mie*q0^2*q2*q3*ry^2 - 6*Ixx*mie*q1^2*q2*q3*ry^2 - 6*Iyy*mie*q0*q1*q2^2*rx^2 + 6*Iyy*mie*q0*q1*q3^2*rx^2 - 6*Iyy*mie*q0^2*q2*q3*rx^2 + 6*Iyy*mie*q1^2*q2*q3*rx^2 - 12*Ixx*mie*q0*q1*q2^2*rz^2 + 12*Ixx*mie*q0*q1*q3^2*rz^2 - 12*Ixx*mie*q0^2*q2*q3*rz^2 + 12*Ixx*mie*q1^2*q2*q3*rz^2 - 6*Iyy*mie*q0*q1*q2^2*ry^2 + 6*Iyy*mie*q0*q1*q3^2*ry^2 - 6*Iyy*mie*q0^2*q2*q3*ry^2 + 6*Iyy*mie*q1^2*q2*q3*ry^2 + 12*Iyy*mie*q0*q1*q2^2*rz^2 - 12*Iyy*mie*q0*q1*q3^2*rz^2 + 12*Iyy*mie*q0^2*q2*q3*rz^2 - 12*Iyy*mie*q1^2*q2*q3*rz^2 - 18*Ixx*mie*q0^2*q1^2*rx*ry + 18*Ixx*mie*q2^2*q3^2*rx*ry + 18*Iyy*mie*q0^2*q1^2*rx*ry - 18*Iyy*mie*q2^2*q3^2*rx*ry - 18*Ixx*mie*q0^2*q1*q2*rx*rz + 18*Ixx*mie*q0*q1^2*q3*rx*rz + 18*Ixx*mie*q0*q2^2*q3*rx*rz - 18*Ixx*mie*q1*q2*q3^2*rx*rz - 18*Ixx*mie*q0*q1^2*q2*ry*rz - 18*Ixx*mie*q0^2*q1*q3*ry*rz - 18*Ixx*mie*q0*q2*q3^2*ry*rz - 18*Ixx*mie*q1*q2^2*q3*ry*rz + 18*Iyy*mie*q0^2*q1*q2*rx*rz - 18*Iyy*mie*q0*q1^2*q3*rx*rz - 18*Iyy*mie*q0*q2^2*q3*rx*rz + 18*Iyy*mie*q1*q2*q3^2*rx*rz + 18*Iyy*mie*q0*q1^2*q2*ry*rz + 18*Iyy*mie*q0^2*q1*q3*ry*rz + 18*Iyy*mie*q0*q2*q3^2*ry*rz + 18*Iyy*mie*q1*q2^2*q3*ry*rz))/(Izz*r_norm^5*(q0^2 + q1^2 + q2^2 + q3^2)^3)];
            
    A(5:7,4) = [- (6*Iyy*mie*q0^3*ry^2 - 6*Iyy*mie*q0^3*rz^2 - 6*Izz*mie*q0^3*ry^2 + 6*Izz*mie*q0^3*rz^2 + 12*Iyy*mie*q0*q1^2*rx^2 - 12*Iyy*mie*q0*q2^2*rx^2 - 6*Iyy*mie*q0*q1^2*ry^2 + 6*Iyy*mie*q0*q2^2*ry^2 - 18*Iyy*mie*q0*q3^2*ry^2 - 12*Izz*mie*q0*q1^2*rx^2 + 12*Izz*mie*q0*q2^2*rx^2 - 6*Iyy*mie*q0*q1^2*rz^2 + 6*Iyy*mie*q0*q2^2*rz^2 + 18*Iyy*mie*q0*q3^2*rz^2 + 6*Izz*mie*q0*q1^2*ry^2 - 6*Izz*mie*q0*q2^2*ry^2 + 18*Izz*mie*q0*q3^2*ry^2 + 6*Izz*mie*q0*q1^2*rz^2 - 6*Izz*mie*q0*q2^2*rz^2 - 18*Izz*mie*q0*q3^2*rz^2 - 4*Iyy*q3^3*r_norm^5*wy*wz + 4*Izz*q3^3*r_norm^5*wy*wz + 6*Iyy*mie*q1^3*rx*ry - 6*Iyy*mie*q2^3*rx*rz - 6*Izz*mie*q1^3*rx*ry + 12*Iyy*mie*q3^3*ry*rz + 6*Izz*mie*q2^3*rx*rz - 12*Izz*mie*q3^3*ry*rz - 24*Iyy*mie*q1*q2*q3*rx^2 + 12*Iyy*mie*q1*q2*q3*ry^2 + 24*Izz*mie*q1*q2*q3*rx^2 + 12*Iyy*mie*q1*q2*q3*rz^2 - 12*Izz*mie*q1*q2*q3*ry^2 - 12*Izz*mie*q1*q2*q3*rz^2 - 18*Iyy*mie*q0^2*q1*rx*ry - 18*Iyy*mie*q1*q2^2*rx*ry + 18*Iyy*mie*q1*q3^2*rx*ry + 18*Iyy*mie*q0^2*q2*rx*rz + 18*Iyy*mie*q1^2*q2*rx*rz - 18*Iyy*mie*q2*q3^2*rx*rz + 18*Izz*mie*q0^2*q1*rx*ry + 18*Izz*mie*q1*q2^2*rx*ry - 18*Izz*mie*q1*q3^2*rx*ry - 36*Iyy*mie*q0^2*q3*ry*rz - 18*Izz*mie*q0^2*q2*rx*rz - 18*Izz*mie*q1^2*q2*rx*rz + 18*Izz*mie*q2*q3^2*rx*rz + 36*Izz*mie*q0^2*q3*ry*rz - 4*Iyy*q0^2*q3*r_norm^5*wy*wz - 4*Iyy*q1^2*q3*r_norm^5*wy*wz - 4*Iyy*q2^2*q3*r_norm^5*wy*wz + 4*Izz*q0^2*q3*r_norm^5*wy*wz + 4*Izz*q1^2*q3*r_norm^5*wy*wz + 4*Izz*q2^2*q3*r_norm^5*wy*wz + 36*Iyy*mie*q0*q2*q3*rx*ry + 36*Iyy*mie*q0*q1*q3*rx*rz - 36*Izz*mie*q0*q2*q3*rx*ry - 36*Izz*mie*q0*q1*q3*rx*rz)/(Ixx*r_norm^5*(q0^2 + q1^2 + q2^2 + q3^2)^2) - (4*q3*(6*Iyy*mie*q0*q3^3*ry^2 + 6*Iyy*mie*q1*q2^3*ry^2 - 6*Iyy*mie*q0^3*q3*ry^2 - 6*Iyy*mie*q1^3*q2*ry^2 - 6*Iyy*mie*q0*q3^3*rz^2 - 6*Iyy*mie*q1*q2^3*rz^2 + 6*Iyy*mie*q0^3*q3*rz^2 + 6*Iyy*mie*q1^3*q2*rz^2 - 6*Izz*mie*q0*q3^3*ry^2 - 6*Izz*mie*q1*q2^3*ry^2 + 6*Izz*mie*q0^3*q3*ry^2 + 6*Izz*mie*q1^3*q2*ry^2 + 6*Izz*mie*q0*q3^3*rz^2 + 6*Izz*mie*q1*q2^3*rz^2 - 6*Izz*mie*q0^3*q3*rz^2 - 6*Izz*mie*q1^3*q2*rz^2 + Iyy*q0^4*r_norm^5*wy*wz + Iyy*q1^4*r_norm^5*wy*wz + Iyy*q2^4*r_norm^5*wy*wz + Iyy*q3^4*r_norm^5*wy*wz - Izz*q0^4*r_norm^5*wy*wz - Izz*q1^4*r_norm^5*wy*wz - Izz*q2^4*r_norm^5*wy*wz - Izz*q3^4*r_norm^5*wy*wz - 3*Iyy*mie*q0^4*ry*rz + 3*Iyy*mie*q1^4*ry*rz + 3*Iyy*mie*q2^4*ry*rz - 3*Iyy*mie*q3^4*ry*rz + 3*Izz*mie*q0^4*ry*rz - 3*Izz*mie*q1^4*ry*rz - 3*Izz*mie*q2^4*ry*rz + 3*Izz*mie*q3^4*ry*rz + 2*Iyy*q0^2*q1^2*r_norm^5*wy*wz + 2*Iyy*q0^2*q2^2*r_norm^5*wy*wz + 2*Iyy*q0^2*q3^2*r_norm^5*wy*wz + 2*Iyy*q1^2*q2^2*r_norm^5*wy*wz + 2*Iyy*q1^2*q3^2*r_norm^5*wy*wz + 2*Iyy*q2^2*q3^2*r_norm^5*wy*wz - 2*Izz*q0^2*q1^2*r_norm^5*wy*wz - 2*Izz*q0^2*q2^2*r_norm^5*wy*wz - 2*Izz*q0^2*q3^2*r_norm^5*wy*wz - 2*Izz*q1^2*q2^2*r_norm^5*wy*wz - 2*Izz*q1^2*q3^2*r_norm^5*wy*wz - 2*Izz*q2^2*q3^2*r_norm^5*wy*wz + 6*Iyy*mie*q0*q2^3*rx*ry + 6*Iyy*mie*q0^3*q2*rx*ry - 6*Iyy*mie*q1*q3^3*rx*ry - 6*Iyy*mie*q1^3*q3*rx*ry + 6*Iyy*mie*q0*q1^3*rx*rz + 6*Iyy*mie*q0^3*q1*rx*rz + 6*Iyy*mie*q2*q3^3*rx*rz + 6*Iyy*mie*q2^3*q3*rx*rz - 6*Izz*mie*q0*q2^3*rx*ry - 6*Izz*mie*q0^3*q2*rx*ry + 6*Izz*mie*q1*q3^3*rx*ry + 6*Izz*mie*q1^3*q3*rx*ry - 6*Izz*mie*q0*q1^3*rx*rz - 6*Izz*mie*q0^3*q1*rx*rz - 6*Izz*mie*q2*q3^3*rx*rz - 6*Izz*mie*q2^3*q3*rx*rz - 12*Iyy*mie*q0^2*q1*q2*rx^2 - 12*Iyy*mie*q0*q1^2*q3*rx^2 + 12*Iyy*mie*q0*q2^2*q3*rx^2 + 12*Iyy*mie*q1*q2*q3^2*rx^2 + 6*Iyy*mie*q0^2*q1*q2*ry^2 + 6*Iyy*mie*q0*q1^2*q3*ry^2 - 6*Iyy*mie*q0*q2^2*q3*ry^2 - 6*Iyy*mie*q1*q2*q3^2*ry^2 + 12*Izz*mie*q0^2*q1*q2*rx^2 + 12*Izz*mie*q0*q1^2*q3*rx^2 - 12*Izz*mie*q0*q2^2*q3*rx^2 - 12*Izz*mie*q1*q2*q3^2*rx^2 + 6*Iyy*mie*q0^2*q1*q2*rz^2 + 6*Iyy*mie*q0*q1^2*q3*rz^2 - 6*Iyy*mie*q0*q2^2*q3*rz^2 - 6*Iyy*mie*q1*q2*q3^2*rz^2 - 6*Izz*mie*q0^2*q1*q2*ry^2 - 6*Izz*mie*q0*q1^2*q3*ry^2 + 6*Izz*mie*q0*q2^2*q3*ry^2 + 6*Izz*mie*q1*q2*q3^2*ry^2 - 6*Izz*mie*q0^2*q1*q2*rz^2 - 6*Izz*mie*q0*q1^2*q3*rz^2 + 6*Izz*mie*q0*q2^2*q3*rz^2 + 6*Izz*mie*q1*q2*q3^2*rz^2 + 18*Iyy*mie*q0^2*q3^2*ry*rz - 18*Iyy*mie*q1^2*q2^2*ry*rz - 18*Izz*mie*q0^2*q3^2*ry*rz + 18*Izz*mie*q1^2*q2^2*ry*rz - 18*Iyy*mie*q0*q1^2*q2*rx*ry + 18*Iyy*mie*q0^2*q1*q3*rx*ry - 18*Iyy*mie*q0*q2*q3^2*rx*ry + 18*Iyy*mie*q1*q2^2*q3*rx*ry - 18*Iyy*mie*q0*q1*q2^2*rx*rz - 18*Iyy*mie*q0*q1*q3^2*rx*rz - 18*Iyy*mie*q0^2*q2*q3*rx*rz - 18*Iyy*mie*q1^2*q2*q3*rx*rz + 18*Izz*mie*q0*q1^2*q2*rx*ry - 18*Izz*mie*q0^2*q1*q3*rx*ry + 18*Izz*mie*q0*q2*q3^2*rx*ry - 18*Izz*mie*q1*q2^2*q3*rx*ry + 18*Izz*mie*q0*q1*q2^2*rx*rz + 18*Izz*mie*q0*q1*q3^2*rx*rz + 18*Izz*mie*q0^2*q2*q3*rx*rz + 18*Izz*mie*q1^2*q2*q3*rx*rz))/(Ixx*r_norm^5*(q0^2 + q1^2 + q2^2 + q3^2)^3);
                (4*q3*(6*Ixx*mie*q0*q2^3*rx^2 - 6*Ixx*mie*q0^3*q2*rx^2 - 6*Ixx*mie*q1*q3^3*rx^2 + 6*Ixx*mie*q1^3*q3*rx^2 - 6*Ixx*mie*q0*q2^3*rz^2 + 6*Ixx*mie*q0^3*q2*rz^2 + 6*Ixx*mie*q1*q3^3*rz^2 - 6*Ixx*mie*q1^3*q3*rz^2 - 6*Izz*mie*q0*q2^3*rx^2 + 6*Izz*mie*q0^3*q2*rx^2 + 6*Izz*mie*q1*q3^3*rx^2 - 6*Izz*mie*q1^3*q3*rx^2 + 6*Izz*mie*q0*q2^3*rz^2 - 6*Izz*mie*q0^3*q2*rz^2 - 6*Izz*mie*q1*q3^3*rz^2 + 6*Izz*mie*q1^3*q3*rz^2 + Ixx*q0^4*r_norm^5*wx*wz + Ixx*q1^4*r_norm^5*wx*wz + Ixx*q2^4*r_norm^5*wx*wz + Ixx*q3^4*r_norm^5*wx*wz - Izz*q0^4*r_norm^5*wx*wz - Izz*q1^4*r_norm^5*wx*wz - Izz*q2^4*r_norm^5*wx*wz - Izz*q3^4*r_norm^5*wx*wz + 3*Ixx*mie*q0^4*rx*rz - 3*Ixx*mie*q1^4*rx*rz + 3*Ixx*mie*q2^4*rx*rz - 3*Ixx*mie*q3^4*rx*rz - 3*Izz*mie*q0^4*rx*rz + 3*Izz*mie*q1^4*rx*rz - 3*Izz*mie*q2^4*rx*rz + 3*Izz*mie*q3^4*rx*rz + 2*Ixx*q0^2*q1^2*r_norm^5*wx*wz + 2*Ixx*q0^2*q2^2*r_norm^5*wx*wz + 2*Ixx*q0^2*q3^2*r_norm^5*wx*wz + 2*Ixx*q1^2*q2^2*r_norm^5*wx*wz + 2*Ixx*q1^2*q3^2*r_norm^5*wx*wz + 2*Ixx*q2^2*q3^2*r_norm^5*wx*wz - 2*Izz*q0^2*q1^2*r_norm^5*wx*wz - 2*Izz*q0^2*q2^2*r_norm^5*wx*wz - 2*Izz*q0^2*q3^2*r_norm^5*wx*wz - 2*Izz*q1^2*q2^2*r_norm^5*wx*wz - 2*Izz*q1^2*q3^2*r_norm^5*wx*wz - 2*Izz*q2^2*q3^2*r_norm^5*wx*wz + 6*Ixx*mie*q0*q3^3*rx*ry + 6*Ixx*mie*q1*q2^3*rx*ry + 6*Ixx*mie*q0^3*q3*rx*ry + 6*Ixx*mie*q1^3*q2*rx*ry + 6*Ixx*mie*q0*q1^3*ry*rz + 6*Ixx*mie*q0^3*q1*ry*rz - 6*Ixx*mie*q2*q3^3*ry*rz - 6*Ixx*mie*q2^3*q3*ry*rz - 6*Izz*mie*q0*q3^3*rx*ry - 6*Izz*mie*q1*q2^3*rx*ry - 6*Izz*mie*q0^3*q3*rx*ry - 6*Izz*mie*q1^3*q2*rx*ry - 6*Izz*mie*q0*q1^3*ry*rz - 6*Izz*mie*q0^3*q1*ry*rz + 6*Izz*mie*q2*q3^3*ry*rz + 6*Izz*mie*q2^3*q3*ry*rz + 6*Ixx*mie*q0*q1^2*q2*rx^2 - 6*Ixx*mie*q0^2*q1*q3*rx^2 - 6*Ixx*mie*q0*q2*q3^2*rx^2 + 6*Ixx*mie*q1*q2^2*q3*rx^2 - 12*Ixx*mie*q0*q1^2*q2*ry^2 + 12*Ixx*mie*q0^2*q1*q3*ry^2 + 12*Ixx*mie*q0*q2*q3^2*ry^2 - 12*Ixx*mie*q1*q2^2*q3*ry^2 + 6*Ixx*mie*q0*q1^2*q2*rz^2 - 6*Ixx*mie*q0^2*q1*q3*rz^2 - 6*Ixx*mie*q0*q2*q3^2*rz^2 + 6*Ixx*mie*q1*q2^2*q3*rz^2 - 6*Izz*mie*q0*q1^2*q2*rx^2 + 6*Izz*mie*q0^2*q1*q3*rx^2 + 6*Izz*mie*q0*q2*q3^2*rx^2 - 6*Izz*mie*q1*q2^2*q3*rx^2 + 12*Izz*mie*q0*q1^2*q2*ry^2 - 12*Izz*mie*q0^2*q1*q3*ry^2 - 12*Izz*mie*q0*q2*q3^2*ry^2 + 12*Izz*mie*q1*q2^2*q3*ry^2 - 6*Izz*mie*q0*q1^2*q2*rz^2 + 6*Izz*mie*q0^2*q1*q3*rz^2 + 6*Izz*mie*q0*q2*q3^2*rz^2 - 6*Izz*mie*q1*q2^2*q3*rz^2 - 18*Ixx*mie*q0^2*q2^2*rx*rz + 18*Ixx*mie*q1^2*q3^2*rx*rz + 18*Izz*mie*q0^2*q2^2*rx*rz - 18*Izz*mie*q1^2*q3^2*rx*rz - 18*Ixx*mie*q0^2*q1*q2*rx*ry - 18*Ixx*mie*q0*q1^2*q3*rx*ry - 18*Ixx*mie*q0*q2^2*q3*rx*ry - 18*Ixx*mie*q1*q2*q3^2*rx*ry - 18*Ixx*mie*q0*q1*q2^2*ry*rz - 18*Ixx*mie*q0*q1*q3^2*ry*rz + 18*Ixx*mie*q0^2*q2*q3*ry*rz + 18*Ixx*mie*q1^2*q2*q3*ry*rz + 18*Izz*mie*q0^2*q1*q2*rx*ry + 18*Izz*mie*q0*q1^2*q3*rx*ry + 18*Izz*mie*q0*q2^2*q3*rx*ry + 18*Izz*mie*q1*q2*q3^2*rx*ry + 18*Izz*mie*q0*q1*q2^2*ry*rz + 18*Izz*mie*q0*q1*q3^2*ry*rz - 18*Izz*mie*q0^2*q2*q3*ry*rz - 18*Izz*mie*q1^2*q2*q3*ry*rz))/(Iyy*r_norm^5*(q0^2 + q1^2 + q2^2 + q3^2)^3) - (6*Ixx*mie*q1^3*rx^2 - 6*Ixx*mie*q1^3*rz^2 - 6*Izz*mie*q1^3*rx^2 + 6*Izz*mie*q1^3*rz^2 - 6*Ixx*mie*q0^2*q1*rx^2 + 6*Ixx*mie*q1*q2^2*rx^2 - 18*Ixx*mie*q1*q3^2*rx^2 + 12*Ixx*mie*q0^2*q1*ry^2 - 12*Ixx*mie*q1*q2^2*ry^2 - 6*Ixx*mie*q0^2*q1*rz^2 + 6*Ixx*mie*q1*q2^2*rz^2 + 18*Ixx*mie*q1*q3^2*rz^2 + 6*Izz*mie*q0^2*q1*rx^2 - 6*Izz*mie*q1*q2^2*rx^2 + 18*Izz*mie*q1*q3^2*rx^2 - 12*Izz*mie*q0^2*q1*ry^2 + 12*Izz*mie*q1*q2^2*ry^2 + 6*Izz*mie*q0^2*q1*rz^2 - 6*Izz*mie*q1*q2^2*rz^2 - 18*Izz*mie*q1*q3^2*rz^2 + 4*Ixx*q3^3*r_norm^5*wx*wz - 4*Izz*q3^3*r_norm^5*wx*wz + 6*Ixx*mie*q0^3*rx*ry - 12*Ixx*mie*q3^3*rx*rz - 6*Ixx*mie*q2^3*ry*rz - 6*Izz*mie*q0^3*rx*ry + 12*Izz*mie*q3^3*rx*rz + 6*Izz*mie*q2^3*ry*rz - 12*Ixx*mie*q0*q2*q3*rx^2 + 24*Ixx*mie*q0*q2*q3*ry^2 - 12*Ixx*mie*q0*q2*q3*rz^2 + 12*Izz*mie*q0*q2*q3*rx^2 - 24*Izz*mie*q0*q2*q3*ry^2 + 12*Izz*mie*q0*q2*q3*rz^2 - 18*Ixx*mie*q0*q1^2*rx*ry - 18*Ixx*mie*q0*q2^2*rx*ry + 18*Ixx*mie*q0*q3^2*rx*ry + 36*Ixx*mie*q1^2*q3*rx*rz + 18*Ixx*mie*q0^2*q2*ry*rz + 18*Ixx*mie*q1^2*q2*ry*rz - 18*Ixx*mie*q2*q3^2*ry*rz + 18*Izz*mie*q0*q1^2*rx*ry + 18*Izz*mie*q0*q2^2*rx*ry - 18*Izz*mie*q0*q3^2*rx*ry - 36*Izz*mie*q1^2*q3*rx*rz - 18*Izz*mie*q0^2*q2*ry*rz - 18*Izz*mie*q1^2*q2*ry*rz + 18*Izz*mie*q2*q3^2*ry*rz + 4*Ixx*q0^2*q3*r_norm^5*wx*wz + 4*Ixx*q1^2*q3*r_norm^5*wx*wz + 4*Ixx*q2^2*q3*r_norm^5*wx*wz - 4*Izz*q0^2*q3*r_norm^5*wx*wz - 4*Izz*q1^2*q3*r_norm^5*wx*wz - 4*Izz*q2^2*q3*r_norm^5*wx*wz - 36*Ixx*mie*q1*q2*q3*rx*ry - 36*Ixx*mie*q0*q1*q3*ry*rz + 36*Izz*mie*q1*q2*q3*rx*ry + 36*Izz*mie*q0*q1*q3*ry*rz)/(Iyy*r_norm^5*(q0^2 + q1^2 + q2^2 + q3^2)^2);
                - (6*Ixx*mie*q2^3*rx^2 - 6*Ixx*mie*q2^3*ry^2 - 6*Iyy*mie*q2^3*rx^2 + 6*Iyy*mie*q2^3*ry^2 - 6*Ixx*mie*q0^2*q2*rx^2 + 6*Ixx*mie*q1^2*q2*rx^2 - 18*Ixx*mie*q2*q3^2*rx^2 - 6*Ixx*mie*q0^2*q2*ry^2 + 6*Ixx*mie*q1^2*q2*ry^2 + 18*Ixx*mie*q2*q3^2*ry^2 + 6*Iyy*mie*q0^2*q2*rx^2 - 6*Iyy*mie*q1^2*q2*rx^2 + 18*Iyy*mie*q2*q3^2*rx^2 + 12*Ixx*mie*q0^2*q2*rz^2 - 12*Ixx*mie*q1^2*q2*rz^2 + 6*Iyy*mie*q0^2*q2*ry^2 - 6*Iyy*mie*q1^2*q2*ry^2 - 18*Iyy*mie*q2*q3^2*ry^2 - 12*Iyy*mie*q0^2*q2*rz^2 + 12*Iyy*mie*q1^2*q2*rz^2 - 4*Ixx*q3^3*r_norm^5*wx*wy + 4*Iyy*q3^3*r_norm^5*wx*wy + 12*Ixx*mie*q3^3*rx*ry + 6*Ixx*mie*q0^3*rx*rz - 12*Iyy*mie*q3^3*rx*ry - 6*Ixx*mie*q1^3*ry*rz - 6*Iyy*mie*q0^3*rx*rz + 6*Iyy*mie*q1^3*ry*rz + 12*Ixx*mie*q0*q1*q3*rx^2 + 12*Ixx*mie*q0*q1*q3*ry^2 - 12*Iyy*mie*q0*q1*q3*rx^2 - 24*Ixx*mie*q0*q1*q3*rz^2 - 12*Iyy*mie*q0*q1*q3*ry^2 + 24*Iyy*mie*q0*q1*q3*rz^2 - 36*Ixx*mie*q2^2*q3*rx*ry - 18*Ixx*mie*q0*q1^2*rx*rz - 18*Ixx*mie*q0*q2^2*rx*rz + 18*Ixx*mie*q0*q3^2*rx*rz + 36*Iyy*mie*q2^2*q3*rx*ry + 18*Ixx*mie*q0^2*q1*ry*rz + 18*Ixx*mie*q1*q2^2*ry*rz - 18*Ixx*mie*q1*q3^2*ry*rz + 18*Iyy*mie*q0*q1^2*rx*rz + 18*Iyy*mie*q0*q2^2*rx*rz - 18*Iyy*mie*q0*q3^2*rx*rz - 18*Iyy*mie*q0^2*q1*ry*rz - 18*Iyy*mie*q1*q2^2*ry*rz + 18*Iyy*mie*q1*q3^2*ry*rz - 4*Ixx*q0^2*q3*r_norm^5*wx*wy - 4*Ixx*q1^2*q3*r_norm^5*wx*wy - 4*Ixx*q2^2*q3*r_norm^5*wx*wy + 4*Iyy*q0^2*q3*r_norm^5*wx*wy + 4*Iyy*q1^2*q3*r_norm^5*wx*wy + 4*Iyy*q2^2*q3*r_norm^5*wx*wy + 36*Ixx*mie*q1*q2*q3*rx*rz + 36*Ixx*mie*q0*q2*q3*ry*rz - 36*Iyy*mie*q1*q2*q3*rx*rz - 36*Iyy*mie*q0*q2*q3*ry*rz)/(Izz*r_norm^5*(q0^2 + q1^2 + q2^2 + q3^2)^2) - (4*q3*(6*Ixx*mie*q0*q1^3*rx^2 - 6*Ixx*mie*q0^3*q1*rx^2 + 6*Ixx*mie*q2*q3^3*rx^2 - 6*Ixx*mie*q2^3*q3*rx^2 - 6*Ixx*mie*q0*q1^3*ry^2 + 6*Ixx*mie*q0^3*q1*ry^2 - 6*Ixx*mie*q2*q3^3*ry^2 + 6*Ixx*mie*q2^3*q3*ry^2 - 6*Iyy*mie*q0*q1^3*rx^2 + 6*Iyy*mie*q0^3*q1*rx^2 - 6*Iyy*mie*q2*q3^3*rx^2 + 6*Iyy*mie*q2^3*q3*rx^2 + 6*Iyy*mie*q0*q1^3*ry^2 - 6*Iyy*mie*q0^3*q1*ry^2 + 6*Iyy*mie*q2*q3^3*ry^2 - 6*Iyy*mie*q2^3*q3*ry^2 + Ixx*q0^4*r_norm^5*wx*wy + Ixx*q1^4*r_norm^5*wx*wy + Ixx*q2^4*r_norm^5*wx*wy + Ixx*q3^4*r_norm^5*wx*wy - Iyy*q0^4*r_norm^5*wx*wy - Iyy*q1^4*r_norm^5*wx*wy - Iyy*q2^4*r_norm^5*wx*wy - Iyy*q3^4*r_norm^5*wx*wy + 3*Ixx*mie*q0^4*rx*ry + 3*Ixx*mie*q1^4*rx*ry - 3*Ixx*mie*q2^4*rx*ry - 3*Ixx*mie*q3^4*rx*ry - 3*Iyy*mie*q0^4*rx*ry - 3*Iyy*mie*q1^4*rx*ry + 3*Iyy*mie*q2^4*rx*ry + 3*Iyy*mie*q3^4*rx*ry + 2*Ixx*q0^2*q1^2*r_norm^5*wx*wy + 2*Ixx*q0^2*q2^2*r_norm^5*wx*wy + 2*Ixx*q0^2*q3^2*r_norm^5*wx*wy + 2*Ixx*q1^2*q2^2*r_norm^5*wx*wy + 2*Ixx*q1^2*q3^2*r_norm^5*wx*wy + 2*Ixx*q2^2*q3^2*r_norm^5*wx*wy - 2*Iyy*q0^2*q1^2*r_norm^5*wx*wy - 2*Iyy*q0^2*q2^2*r_norm^5*wx*wy - 2*Iyy*q0^2*q3^2*r_norm^5*wx*wy - 2*Iyy*q1^2*q2^2*r_norm^5*wx*wy - 2*Iyy*q1^2*q3^2*r_norm^5*wx*wy - 2*Iyy*q2^2*q3^2*r_norm^5*wx*wy - 6*Ixx*mie*q0*q3^3*rx*rz + 6*Ixx*mie*q1*q2^3*rx*rz - 6*Ixx*mie*q0^3*q3*rx*rz + 6*Ixx*mie*q1^3*q2*rx*rz + 6*Ixx*mie*q0*q2^3*ry*rz + 6*Ixx*mie*q0^3*q2*ry*rz + 6*Ixx*mie*q1*q3^3*ry*rz + 6*Ixx*mie*q1^3*q3*ry*rz + 6*Iyy*mie*q0*q3^3*rx*rz - 6*Iyy*mie*q1*q2^3*rx*rz + 6*Iyy*mie*q0^3*q3*rx*rz - 6*Iyy*mie*q1^3*q2*rx*rz - 6*Iyy*mie*q0*q2^3*ry*rz - 6*Iyy*mie*q0^3*q2*ry*rz - 6*Iyy*mie*q1*q3^3*ry*rz - 6*Iyy*mie*q1^3*q3*ry*rz + 6*Ixx*mie*q0*q1*q2^2*rx^2 - 6*Ixx*mie*q0*q1*q3^2*rx^2 + 6*Ixx*mie*q0^2*q2*q3*rx^2 - 6*Ixx*mie*q1^2*q2*q3*rx^2 + 6*Ixx*mie*q0*q1*q2^2*ry^2 - 6*Ixx*mie*q0*q1*q3^2*ry^2 + 6*Ixx*mie*q0^2*q2*q3*ry^2 - 6*Ixx*mie*q1^2*q2*q3*ry^2 - 6*Iyy*mie*q0*q1*q2^2*rx^2 + 6*Iyy*mie*q0*q1*q3^2*rx^2 - 6*Iyy*mie*q0^2*q2*q3*rx^2 + 6*Iyy*mie*q1^2*q2*q3*rx^2 - 12*Ixx*mie*q0*q1*q2^2*rz^2 + 12*Ixx*mie*q0*q1*q3^2*rz^2 - 12*Ixx*mie*q0^2*q2*q3*rz^2 + 12*Ixx*mie*q1^2*q2*q3*rz^2 - 6*Iyy*mie*q0*q1*q2^2*ry^2 + 6*Iyy*mie*q0*q1*q3^2*ry^2 - 6*Iyy*mie*q0^2*q2*q3*ry^2 + 6*Iyy*mie*q1^2*q2*q3*ry^2 + 12*Iyy*mie*q0*q1*q2^2*rz^2 - 12*Iyy*mie*q0*q1*q3^2*rz^2 + 12*Iyy*mie*q0^2*q2*q3*rz^2 - 12*Iyy*mie*q1^2*q2*q3*rz^2 - 18*Ixx*mie*q0^2*q1^2*rx*ry + 18*Ixx*mie*q2^2*q3^2*rx*ry + 18*Iyy*mie*q0^2*q1^2*rx*ry - 18*Iyy*mie*q2^2*q3^2*rx*ry - 18*Ixx*mie*q0^2*q1*q2*rx*rz + 18*Ixx*mie*q0*q1^2*q3*rx*rz + 18*Ixx*mie*q0*q2^2*q3*rx*rz - 18*Ixx*mie*q1*q2*q3^2*rx*rz - 18*Ixx*mie*q0*q1^2*q2*ry*rz - 18*Ixx*mie*q0^2*q1*q3*ry*rz - 18*Ixx*mie*q0*q2*q3^2*ry*rz - 18*Ixx*mie*q1*q2^2*q3*ry*rz + 18*Iyy*mie*q0^2*q1*q2*rx*rz - 18*Iyy*mie*q0*q1^2*q3*rx*rz - 18*Iyy*mie*q0*q2^2*q3*rx*rz + 18*Iyy*mie*q1*q2*q3^2*rx*rz + 18*Iyy*mie*q0*q1^2*q2*ry*rz + 18*Iyy*mie*q0^2*q1*q3*ry*rz + 18*Iyy*mie*q0*q2*q3^2*ry*rz + 18*Iyy*mie*q1*q2^2*q3*ry*rz))/(Izz*r_norm^5*(q0^2 + q1^2 + q2^2 + q3^2)^3)];
            
    A(5:7,5) = [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            0;
                -(Ixx*q0^4*r_norm^5*wz + Ixx*q1^4*r_norm^5*wz + Ixx*q2^4*r_norm^5*wz + Ixx*q3^4*r_norm^5*wz - Izz*q0^4*r_norm^5*wz - Izz*q1^4*r_norm^5*wz - Izz*q2^4*r_norm^5*wz - Izz*q3^4*r_norm^5*wz + 2*Ixx*q0^2*q1^2*r_norm^5*wz + 2*Ixx*q0^2*q2^2*r_norm^5*wz + 2*Ixx*q0^2*q3^2*r_norm^5*wz + 2*Ixx*q1^2*q2^2*r_norm^5*wz + 2*Ixx*q1^2*q3^2*r_norm^5*wz + 2*Ixx*q2^2*q3^2*r_norm^5*wz - 2*Izz*q0^2*q1^2*r_norm^5*wz - 2*Izz*q0^2*q2^2*r_norm^5*wz - 2*Izz*q0^2*q3^2*r_norm^5*wz - 2*Izz*q1^2*q2^2*r_norm^5*wz - 2*Izz*q1^2*q3^2*r_norm^5*wz - 2*Izz*q2^2*q3^2*r_norm^5*wz)/(Iyy*r_norm^5*(q0^2 + q1^2 + q2^2 + q3^2)^2);
                (Ixx*q0^4*r_norm^5*wy + Ixx*q1^4*r_norm^5*wy + Ixx*q2^4*r_norm^5*wy + Ixx*q3^4*r_norm^5*wy - Iyy*q0^4*r_norm^5*wy - Iyy*q1^4*r_norm^5*wy - Iyy*q2^4*r_norm^5*wy - Iyy*q3^4*r_norm^5*wy + 2*Ixx*q0^2*q1^2*r_norm^5*wy + 2*Ixx*q0^2*q2^2*r_norm^5*wy + 2*Ixx*q0^2*q3^2*r_norm^5*wy + 2*Ixx*q1^2*q2^2*r_norm^5*wy + 2*Ixx*q1^2*q3^2*r_norm^5*wy + 2*Ixx*q2^2*q3^2*r_norm^5*wy - 2*Iyy*q0^2*q1^2*r_norm^5*wy - 2*Iyy*q0^2*q2^2*r_norm^5*wy - 2*Iyy*q0^2*q3^2*r_norm^5*wy - 2*Iyy*q1^2*q2^2*r_norm^5*wy - 2*Iyy*q1^2*q3^2*r_norm^5*wy - 2*Iyy*q2^2*q3^2*r_norm^5*wy)/(Izz*r_norm^5*(q0^2 + q1^2 + q2^2 + q3^2)^2)];
            
    A(5:7,6) = [(Iyy*q0^4*r_norm^5*wz + Iyy*q1^4*r_norm^5*wz + Iyy*q2^4*r_norm^5*wz + Iyy*q3^4*r_norm^5*wz - Izz*q0^4*r_norm^5*wz - Izz*q1^4*r_norm^5*wz - Izz*q2^4*r_norm^5*wz - Izz*q3^4*r_norm^5*wz + 2*Iyy*q0^2*q1^2*r_norm^5*wz + 2*Iyy*q0^2*q2^2*r_norm^5*wz + 2*Iyy*q0^2*q3^2*r_norm^5*wz + 2*Iyy*q1^2*q2^2*r_norm^5*wz + 2*Iyy*q1^2*q3^2*r_norm^5*wz + 2*Iyy*q2^2*q3^2*r_norm^5*wz - 2*Izz*q0^2*q1^2*r_norm^5*wz - 2*Izz*q0^2*q2^2*r_norm^5*wz - 2*Izz*q0^2*q3^2*r_norm^5*wz - 2*Izz*q1^2*q2^2*r_norm^5*wz - 2*Izz*q1^2*q3^2*r_norm^5*wz - 2*Izz*q2^2*q3^2*r_norm^5*wz)/(Ixx*r_norm^5*(q0^2 + q1^2 + q2^2 + q3^2)^2);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           0;    
                (Ixx*q0^4*r_norm^5*wx + Ixx*q1^4*r_norm^5*wx + Ixx*q2^4*r_norm^5*wx + Ixx*q3^4*r_norm^5*wx - Iyy*q0^4*r_norm^5*wx - Iyy*q1^4*r_norm^5*wx - Iyy*q2^4*r_norm^5*wx - Iyy*q3^4*r_norm^5*wx + 2*Ixx*q0^2*q1^2*r_norm^5*wx + 2*Ixx*q0^2*q2^2*r_norm^5*wx + 2*Ixx*q0^2*q3^2*r_norm^5*wx + 2*Ixx*q1^2*q2^2*r_norm^5*wx + 2*Ixx*q1^2*q3^2*r_norm^5*wx + 2*Ixx*q2^2*q3^2*r_norm^5*wx - 2*Iyy*q0^2*q1^2*r_norm^5*wx - 2*Iyy*q0^2*q2^2*r_norm^5*wx - 2*Iyy*q0^2*q3^2*r_norm^5*wx - 2*Iyy*q1^2*q2^2*r_norm^5*wx - 2*Iyy*q1^2*q3^2*r_norm^5*wx - 2*Iyy*q2^2*q3^2*r_norm^5*wx)/(Izz*r_norm^5*(q0^2 + q1^2 + q2^2 + q3^2)^2)];
            
    A(5:7,7) = [(Iyy*q0^4*r_norm^5*wy + Iyy*q1^4*r_norm^5*wy + Iyy*q2^4*r_norm^5*wy + Iyy*q3^4*r_norm^5*wy - Izz*q0^4*r_norm^5*wy - Izz*q1^4*r_norm^5*wy - Izz*q2^4*r_norm^5*wy - Izz*q3^4*r_norm^5*wy + 2*Iyy*q0^2*q1^2*r_norm^5*wy + 2*Iyy*q0^2*q2^2*r_norm^5*wy + 2*Iyy*q0^2*q3^2*r_norm^5*wy + 2*Iyy*q1^2*q2^2*r_norm^5*wy + 2*Iyy*q1^2*q3^2*r_norm^5*wy + 2*Iyy*q2^2*q3^2*r_norm^5*wy - 2*Izz*q0^2*q1^2*r_norm^5*wy - 2*Izz*q0^2*q2^2*r_norm^5*wy - 2*Izz*q0^2*q3^2*r_norm^5*wy - 2*Izz*q1^2*q2^2*r_norm^5*wy - 2*Izz*q1^2*q3^2*r_norm^5*wy - 2*Izz*q2^2*q3^2*r_norm^5*wy)/(Ixx*r_norm^5*(q0^2 + q1^2 + q2^2 + q3^2)^2);
                -(Ixx*q0^4*r_norm^5*wx + Ixx*q1^4*r_norm^5*wx + Ixx*q2^4*r_norm^5*wx + Ixx*q3^4*r_norm^5*wx - Izz*q0^4*r_norm^5*wx - Izz*q1^4*r_norm^5*wx - Izz*q2^4*r_norm^5*wx - Izz*q3^4*r_norm^5*wx + 2*Ixx*q0^2*q1^2*r_norm^5*wx + 2*Ixx*q0^2*q2^2*r_norm^5*wx + 2*Ixx*q0^2*q3^2*r_norm^5*wx + 2*Ixx*q1^2*q2^2*r_norm^5*wx + 2*Ixx*q1^2*q3^2*r_norm^5*wx + 2*Ixx*q2^2*q3^2*r_norm^5*wx - 2*Izz*q0^2*q1^2*r_norm^5*wx - 2*Izz*q0^2*q2^2*r_norm^5*wx - 2*Izz*q0^2*q3^2*r_norm^5*wx - 2*Izz*q1^2*q2^2*r_norm^5*wx - 2*Izz*q1^2*q3^2*r_norm^5*wx - 2*Izz*q2^2*q3^2*r_norm^5*wx)/(Iyy*r_norm^5*(q0^2 + q1^2 + q2^2 + q3^2)^2);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            0];
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
end