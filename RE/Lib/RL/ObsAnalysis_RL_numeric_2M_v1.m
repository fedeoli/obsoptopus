%%%% NUMERIC ORC COMPUTATION %%%%
function dtheta = ObsAnalysis_RL_numeric_2M_v1(map,x,y)

    % quaternion
    q0 = x(1);
    q1 = x(2);
    q2 = x(3);
    q3 = x(4);
    
    % omega
    wx = x(5);
    wy = x(6);
    wz = x(7);
    
    % magnetometers
    if map.nMagneto >= 1
        Bx1 = y(4);
        By1 = y(5);
        Bz1 = y(6);
    end
    if map.nMagneto >= 2
        Bx2 = y(7);
        By2 = y(8);
        Bz2 = y(9);
    end
    
    dtheta =    [  0,   0,   0, 2.0*Bx1*q0 + 2.0*By1*q3 - 2.0*Bz1*q2, 2.0*By1*q0 - 2.0*Bx1*q3 + 2.0*Bz1*q1, 2.0*Bx1*q2 - 2.0*By1*q1 + 2.0*Bz1*q0, 2.0*Bx2*q0 + 2.0*By2*q3 - 2.0*Bz2*q2, 2.0*By2*q0 - 2.0*Bx2*q3 + 2.0*Bz2*q1, 2.0*Bx2*q2 - 2.0*By2*q1 + 2.0*Bz2*q0, 0, - 1.4e-6*q0^3 - 1.9e-7*q0^2*q1 + 1.6e-5*q0^2*q2 + 1.5e-6*q0^2*q3 + 2.9e-6*q0*q1*q2 - 1.1e-5*q0*q1*q3 + 4.3e-6*q0*q2^2 + 3.9e-7*q0*q2*q3 - 6.5e-8*q1^3 - 5.3e-6*q1^2*q2 - 1.5e-6*q1^2*q3 + 1.9e-7*q1*q2^2 + 1.9e-7*q1*q3^2 - 5.2e-6*q2^3 - 1.5e-6*q2^2*q3 + 5.3e-6*q2*q3^2 + 4.8e-7*q3^3, - 1.3e-7*q0^3 + 2.1e-6*q0^2*q1 + 1.5e-6*q0^2*q2 - 1.5e-7*q0^2*q3 - 2.1e-5*q0*q1*q2 - 2.9e-6*q0*q1*q3 + 4.3e-6*q0*q2*q3 + 3.9e-7*q0*q3^2 + 7.1e-7*q1^3 - 1.5e-6*q1^2*q2 + 1.0e-5*q1^2*q3 - 2.1e-6*q1*q2^2 - 2.1e-6*q1*q3^2 + 4.8e-7*q2^3 - 1.0e-5*q2^2*q3 - 1.5e-6*q2*q3^2 + 5.1e-8*q3^3, 0.5*wx*(2.0*Bx1*q1 + 2.0*By1*q2 + 2.0*Bz1*q3) - 0.5*wy*(2.0*Bx1*q2 - 2.0*By1*q1 + 2.0*Bz1*q0) + 0.5*wz*(2.0*By1*q0 - 2.0*Bx1*q3 + 2.0*Bz1*q1) - 2.0*Bx1*(0.5*q1*wx + 0.5*q2*wy + 0.5*q3*wz) + 2.0*By1*(0.5*q1*wy - 0.5*q2*wx + 0.5*q0*wz) - 2.0*Bz1*(0.5*q3*wx + 0.5*q0*wy - 0.5*q1*wz), 0.5*wx*(2.0*Bx1*q2 - 2.0*By1*q1 + 2.0*Bz1*q0) + 0.5*wy*(2.0*Bx1*q1 + 2.0*By1*q2 + 2.0*Bz1*q3) - 0.5*wz*(2.0*Bx1*q0 + 2.0*By1*q3 - 2.0*Bz1*q2) - 2.0*Bx1*(0.5*q1*wy - 0.5*q2*wx + 0.5*q0*wz) - 2.0*By1*(0.5*q1*wx + 0.5*q2*wy + 0.5*q3*wz) + 2.0*Bz1*(0.5*q0*wx - 0.5*q3*wy + 0.5*q2*wz), 0.5*wy*(2.0*Bx1*q0 + 2.0*By1*q3 - 2.0*Bz1*q2) - 0.5*wx*(2.0*By1*q0 - 2.0*Bx1*q3 + 2.0*Bz1*q1) + 0.5*wz*(2.0*Bx1*q1 + 2.0*By1*q2 + 2.0*Bz1*q3) + 2.0*Bx1*(0.5*q3*wx + 0.5*q0*wy - 0.5*q1*wz) - 2.0*By1*(0.5*q0*wx - 0.5*q3*wy + 0.5*q2*wz) - 2.0*Bz1*(0.5*q1*wx + 0.5*q2*wy + 0.5*q3*wz), 0.5*wx*(2.0*Bx2*q1 + 2.0*By2*q2 + 2.0*Bz2*q3) - 0.5*wy*(2.0*Bx2*q2 - 2.0*By2*q1 + 2.0*Bz2*q0) + 0.5*wz*(2.0*By2*q0 - 2.0*Bx2*q3 + 2.0*Bz2*q1) - 2.0*Bx2*(0.5*q1*wx + 0.5*q2*wy + 0.5*q3*wz) + 2.0*By2*(0.5*q1*wy - 0.5*q2*wx + 0.5*q0*wz) - 2.0*Bz2*(0.5*q3*wx + 0.5*q0*wy - 0.5*q1*wz), 0.5*wx*(2.0*Bx2*q2 - 2.0*By2*q1 + 2.0*Bz2*q0) + 0.5*wy*(2.0*Bx2*q1 + 2.0*By2*q2 + 2.0*Bz2*q3) - 0.5*wz*(2.0*Bx2*q0 + 2.0*By2*q3 - 2.0*Bz2*q2) - 2.0*Bx2*(0.5*q1*wy - 0.5*q2*wx + 0.5*q0*wz) - 2.0*By2*(0.5*q1*wx + 0.5*q2*wy + 0.5*q3*wz) + 2.0*Bz2*(0.5*q0*wx - 0.5*q3*wy + 0.5*q2*wz), 0.5*wy*(2.0*Bx2*q0 + 2.0*By2*q3 - 2.0*Bz2*q2) - 0.5*wx*(2.0*By2*q0 - 2.0*Bx2*q3 + 2.0*Bz2*q1) + 0.5*wz*(2.0*Bx2*q1 + 2.0*By2*q2 + 2.0*Bz2*q3) + 2.0*Bx2*(0.5*q3*wx + 0.5*q0*wy - 0.5*q1*wz) - 2.0*By2*(0.5*q0*wx - 0.5*q3*wy + 0.5*q2*wz) - 2.0*Bz2*(0.5*q1*wx + 0.5*q2*wy + 0.5*q3*wz);
                0,   0,   0, 2.0*Bx1*q1 + 2.0*By1*q2 + 2.0*Bz1*q3, 2.0*Bx1*q2 - 2.0*By1*q1 + 2.0*Bz1*q0, 2.0*Bx1*q3 - 2.0*By1*q0 - 2.0*Bz1*q1, 2.0*Bx2*q1 + 2.0*By2*q2 + 2.0*Bz2*q3, 2.0*Bx2*q2 - 2.0*By2*q1 + 2.0*Bz2*q0, 2.0*Bx2*q3 - 2.0*By2*q0 - 2.0*Bz2*q1, 0, - 6.5e-8*q0^3 + 1.5e-6*q0^2*q2 - 5.3e-6*q0^2*q3 - 1.9e-7*q0*q1^2 - 1.1e-5*q0*q1*q2 - 2.9e-6*q0*q1*q3 + 1.9e-7*q0*q2^2 + 1.9e-7*q0*q3^2 + 1.4e-6*q1^3 - 1.5e-6*q1^2*q2 + 1.6e-5*q1^2*q3 + 3.9e-7*q1*q2*q3 - 4.3e-6*q1*q3^2 - 4.8e-7*q2^3 + 5.3e-6*q2^2*q3 + 1.5e-6*q2*q3^2 - 5.2e-6*q3^3,   7.1e-7*q0^3 - 1.0e-5*q0^2*q2 - 1.5e-6*q0^2*q3 + 2.1e-6*q0*q1^2 - 2.9e-6*q0*q1*q2 + 2.1e-5*q0*q1*q3 - 2.1e-6*q0*q2^2 - 2.1e-6*q0*q3^2 + 1.3e-7*q1^3 + 1.5e-7*q1^2*q2 + 1.5e-6*q1^2*q3 - 3.9e-7*q1*q2^2 + 4.3e-6*q1*q2*q3 - 5.1e-8*q2^3 - 1.5e-6*q2^2*q3 + 1.0e-5*q2*q3^2 + 4.8e-7*q3^3, 0.5*wy*(2.0*By1*q0 - 2.0*Bx1*q3 + 2.0*Bz1*q1) - 0.5*wx*(2.0*Bx1*q0 + 2.0*By1*q3 - 2.0*Bz1*q2) + 0.5*wz*(2.0*Bx1*q2 - 2.0*By1*q1 + 2.0*Bz1*q0) + 2.0*Bx1*(0.5*q0*wx - 0.5*q3*wy + 0.5*q2*wz) + 2.0*By1*(0.5*q3*wx + 0.5*q0*wy - 0.5*q1*wz) + 2.0*Bz1*(0.5*q1*wy - 0.5*q2*wx + 0.5*q0*wz), 2.0*Bx1*(0.5*q3*wx + 0.5*q0*wy - 0.5*q1*wz) - 0.5*wy*(2.0*Bx1*q0 + 2.0*By1*q3 - 2.0*Bz1*q2) - 0.5*wz*(2.0*Bx1*q1 + 2.0*By1*q2 + 2.0*Bz1*q3) - 0.5*wx*(2.0*By1*q0 - 2.0*Bx1*q3 + 2.0*Bz1*q1) - 2.0*By1*(0.5*q0*wx - 0.5*q3*wy + 0.5*q2*wz) - 2.0*Bz1*(0.5*q1*wx + 0.5*q2*wy + 0.5*q3*wz), 0.5*wy*(2.0*Bx1*q1 + 2.0*By1*q2 + 2.0*Bz1*q3) - 0.5*wx*(2.0*Bx1*q2 - 2.0*By1*q1 + 2.0*Bz1*q0) - 0.5*wz*(2.0*Bx1*q0 + 2.0*By1*q3 - 2.0*Bz1*q2) + 2.0*Bx1*(0.5*q1*wy - 0.5*q2*wx + 0.5*q0*wz) + 2.0*By1*(0.5*q1*wx + 0.5*q2*wy + 0.5*q3*wz) - 2.0*Bz1*(0.5*q0*wx - 0.5*q3*wy + 0.5*q2*wz), 0.5*wy*(2.0*By2*q0 - 2.0*Bx2*q3 + 2.0*Bz2*q1) - 0.5*wx*(2.0*Bx2*q0 + 2.0*By2*q3 - 2.0*Bz2*q2) + 0.5*wz*(2.0*Bx2*q2 - 2.0*By2*q1 + 2.0*Bz2*q0) + 2.0*Bx2*(0.5*q0*wx - 0.5*q3*wy + 0.5*q2*wz) + 2.0*By2*(0.5*q3*wx + 0.5*q0*wy - 0.5*q1*wz) + 2.0*Bz2*(0.5*q1*wy - 0.5*q2*wx + 0.5*q0*wz), 2.0*Bx2*(0.5*q3*wx + 0.5*q0*wy - 0.5*q1*wz) - 0.5*wy*(2.0*Bx2*q0 + 2.0*By2*q3 - 2.0*Bz2*q2) - 0.5*wz*(2.0*Bx2*q1 + 2.0*By2*q2 + 2.0*Bz2*q3) - 0.5*wx*(2.0*By2*q0 - 2.0*Bx2*q3 + 2.0*Bz2*q1) - 2.0*By2*(0.5*q0*wx - 0.5*q3*wy + 0.5*q2*wz) - 2.0*Bz2*(0.5*q1*wx + 0.5*q2*wy + 0.5*q3*wz), 0.5*wy*(2.0*Bx2*q1 + 2.0*By2*q2 + 2.0*Bz2*q3) - 0.5*wx*(2.0*Bx2*q2 - 2.0*By2*q1 + 2.0*Bz2*q0) - 0.5*wz*(2.0*Bx2*q0 + 2.0*By2*q3 - 2.0*Bz2*q2) + 2.0*Bx2*(0.5*q1*wy - 0.5*q2*wx + 0.5*q0*wz) + 2.0*By2*(0.5*q1*wx + 0.5*q2*wy + 0.5*q3*wz) - 2.0*Bz2*(0.5*q0*wx - 0.5*q3*wy + 0.5*q2*wz);
                0,   0,   0, 2.0*By1*q1 - 2.0*Bx1*q2 - 2.0*Bz1*q0, 2.0*Bx1*q1 + 2.0*By1*q2 + 2.0*Bz1*q3, 2.0*Bx1*q0 + 2.0*By1*q3 - 2.0*Bz1*q2, 2.0*By2*q1 - 2.0*Bx2*q2 - 2.0*Bz2*q0, 2.0*Bx2*q1 + 2.0*By2*q2 + 2.0*Bz2*q3, 2.0*Bx2*q0 + 2.0*By2*q3 - 2.0*Bz2*q2, 0,   5.2e-6*q0^3 + 1.5e-6*q0^2*q1 + 4.3e-6*q0^2*q2 + 1.9e-7*q0^2*q3 - 5.3e-6*q0*q1^2 + 3.9e-7*q0*q1*q2 - 1.6e-5*q0*q2^2 - 2.9e-6*q0*q2*q3 + 5.3e-6*q0*q3^2 - 4.8e-7*q1^3 + 1.9e-7*q1^2*q3 - 1.5e-6*q1*q2^2 + 1.1e-5*q1*q2*q3 + 1.5e-6*q1*q3^2 - 1.4e-6*q2^3 - 1.9e-7*q2^2*q3 - 6.5e-8*q3^3,   4.8e-7*q0^3 - 1.0e-5*q0^2*q1 + 2.1e-6*q0^2*q3 - 1.5e-6*q0*q1^2 - 4.3e-6*q0*q1*q2 + 1.5e-6*q0*q2^2 - 2.1e-5*q0*q2*q3 - 1.5e-6*q0*q3^2 + 5.1e-8*q1^3 - 3.9e-7*q1^2*q2 + 2.1e-6*q1^2*q3 - 1.5e-7*q1*q2^2 - 2.9e-6*q1*q2*q3 + 1.0e-5*q1*q3^2 + 1.3e-7*q2^3 - 2.1e-6*q2^2*q3 - 7.1e-7*q3^3, 0.5*wz*(2.0*Bx1*q1 + 2.0*By1*q2 + 2.0*Bz1*q3) - 0.5*wy*(2.0*Bx1*q0 + 2.0*By1*q3 - 2.0*Bz1*q2) - 0.5*wx*(2.0*By1*q0 - 2.0*Bx1*q3 + 2.0*Bz1*q1) - 2.0*Bx1*(0.5*q3*wx + 0.5*q0*wy - 0.5*q1*wz) + 2.0*By1*(0.5*q0*wx - 0.5*q3*wy + 0.5*q2*wz) + 2.0*Bz1*(0.5*q1*wx + 0.5*q2*wy + 0.5*q3*wz), 0.5*wx*(2.0*Bx1*q0 + 2.0*By1*q3 - 2.0*Bz1*q2) - 0.5*wy*(2.0*By1*q0 - 2.0*Bx1*q3 + 2.0*Bz1*q1) + 0.5*wz*(2.0*Bx1*q2 - 2.0*By1*q1 + 2.0*Bz1*q0) + 2.0*Bx1*(0.5*q0*wx - 0.5*q3*wy + 0.5*q2*wz) + 2.0*By1*(0.5*q3*wx + 0.5*q0*wy - 0.5*q1*wz) + 2.0*Bz1*(0.5*q1*wy - 0.5*q2*wx + 0.5*q0*wz), 2.0*By1*(0.5*q1*wy - 0.5*q2*wx + 0.5*q0*wz) - 0.5*wy*(2.0*Bx1*q2 - 2.0*By1*q1 + 2.0*Bz1*q0) - 0.5*wz*(2.0*By1*q0 - 2.0*Bx1*q3 + 2.0*Bz1*q1) - 2.0*Bx1*(0.5*q1*wx + 0.5*q2*wy + 0.5*q3*wz) - 0.5*wx*(2.0*Bx1*q1 + 2.0*By1*q2 + 2.0*Bz1*q3) - 2.0*Bz1*(0.5*q3*wx + 0.5*q0*wy - 0.5*q1*wz), 0.5*wz*(2.0*Bx2*q1 + 2.0*By2*q2 + 2.0*Bz2*q3) - 0.5*wy*(2.0*Bx2*q0 + 2.0*By2*q3 - 2.0*Bz2*q2) - 0.5*wx*(2.0*By2*q0 - 2.0*Bx2*q3 + 2.0*Bz2*q1) - 2.0*Bx2*(0.5*q3*wx + 0.5*q0*wy - 0.5*q1*wz) + 2.0*By2*(0.5*q0*wx - 0.5*q3*wy + 0.5*q2*wz) + 2.0*Bz2*(0.5*q1*wx + 0.5*q2*wy + 0.5*q3*wz), 0.5*wx*(2.0*Bx2*q0 + 2.0*By2*q3 - 2.0*Bz2*q2) - 0.5*wy*(2.0*By2*q0 - 2.0*Bx2*q3 + 2.0*Bz2*q1) + 0.5*wz*(2.0*Bx2*q2 - 2.0*By2*q1 + 2.0*Bz2*q0) + 2.0*Bx2*(0.5*q0*wx - 0.5*q3*wy + 0.5*q2*wz) + 2.0*By2*(0.5*q3*wx + 0.5*q0*wy - 0.5*q1*wz) + 2.0*Bz2*(0.5*q1*wy - 0.5*q2*wx + 0.5*q0*wz), 2.0*By2*(0.5*q1*wy - 0.5*q2*wx + 0.5*q0*wz) - 0.5*wy*(2.0*Bx2*q2 - 2.0*By2*q1 + 2.0*Bz2*q0) - 0.5*wz*(2.0*By2*q0 - 2.0*Bx2*q3 + 2.0*Bz2*q1) - 2.0*Bx2*(0.5*q1*wx + 0.5*q2*wy + 0.5*q3*wz) - 0.5*wx*(2.0*Bx2*q1 + 2.0*By2*q2 + 2.0*Bz2*q3) - 2.0*Bz2*(0.5*q3*wx + 0.5*q0*wy - 0.5*q1*wz);
                0,   0,   0, 2.0*By1*q0 - 2.0*Bx1*q3 + 2.0*Bz1*q1, 2.0*Bz1*q2 - 2.0*By1*q3 - 2.0*Bx1*q0, 2.0*Bx1*q1 + 2.0*By1*q2 + 2.0*Bz1*q3, 2.0*By2*q0 - 2.0*Bx2*q3 + 2.0*Bz2*q1, 2.0*Bz2*q2 - 2.0*By2*q3 - 2.0*Bx2*q0, 2.0*Bx2*q1 + 2.0*By2*q2 + 2.0*Bz2*q3, 0,   4.8e-7*q0^3 - 5.3e-6*q0^2*q1 + 1.9e-7*q0^2*q2 - 1.5e-6*q0*q1^2 + 3.9e-7*q0*q1*q3 - 1.5e-6*q0*q2^2 + 1.1e-5*q0*q2*q3 + 1.5e-6*q0*q3^2 + 5.2e-6*q1^3 + 1.9e-7*q1^2*q2 - 4.3e-6*q1^2*q3 + 5.3e-6*q1*q2^2 + 2.9e-6*q1*q2*q3 - 1.6e-5*q1*q3^2 - 6.5e-8*q2^3 - 1.9e-7*q2*q3^2 + 1.4e-6*q3^3, - 5.1e-8*q0^3 - 1.5e-6*q0^2*q1 + 2.1e-6*q0^2*q2 + 3.9e-7*q0^2*q3 + 1.0e-5*q0*q1^2 - 4.3e-6*q0*q1*q3 - 1.0e-5*q0*q2^2 - 2.9e-6*q0*q2*q3 + 1.5e-7*q0*q3^2 + 4.8e-7*q1^3 + 2.1e-6*q1^2*q2 - 1.5e-6*q1*q2^2 + 2.1e-5*q1*q2*q3 + 1.5e-6*q1*q3^2 - 7.1e-7*q2^3 - 2.1e-6*q2*q3^2 - 1.3e-7*q3^3, 2.0*Bz1*(0.5*q0*wx - 0.5*q3*wy + 0.5*q2*wz) - 0.5*wy*(2.0*Bx1*q1 + 2.0*By1*q2 + 2.0*Bz1*q3) - 0.5*wz*(2.0*Bx1*q0 + 2.0*By1*q3 - 2.0*Bz1*q2) - 2.0*Bx1*(0.5*q1*wy - 0.5*q2*wx + 0.5*q0*wz) - 2.0*By1*(0.5*q1*wx + 0.5*q2*wy + 0.5*q3*wz) - 0.5*wx*(2.0*Bx1*q2 - 2.0*By1*q1 + 2.0*Bz1*q0), 0.5*wx*(2.0*Bx1*q1 + 2.0*By1*q2 + 2.0*Bz1*q3) - 0.5*wy*(2.0*Bx1*q2 - 2.0*By1*q1 + 2.0*Bz1*q0) - 0.5*wz*(2.0*By1*q0 - 2.0*Bx1*q3 + 2.0*Bz1*q1) + 2.0*Bx1*(0.5*q1*wx + 0.5*q2*wy + 0.5*q3*wz) - 2.0*By1*(0.5*q1*wy - 0.5*q2*wx + 0.5*q0*wz) + 2.0*Bz1*(0.5*q3*wx + 0.5*q0*wy - 0.5*q1*wz), 0.5*wx*(2.0*Bx1*q0 + 2.0*By1*q3 - 2.0*Bz1*q2) + 0.5*wy*(2.0*By1*q0 - 2.0*Bx1*q3 + 2.0*Bz1*q1) - 0.5*wz*(2.0*Bx1*q2 - 2.0*By1*q1 + 2.0*Bz1*q0) + 2.0*Bx1*(0.5*q0*wx - 0.5*q3*wy + 0.5*q2*wz) + 2.0*By1*(0.5*q3*wx + 0.5*q0*wy - 0.5*q1*wz) + 2.0*Bz1*(0.5*q1*wy - 0.5*q2*wx + 0.5*q0*wz), 2.0*Bz2*(0.5*q0*wx - 0.5*q3*wy + 0.5*q2*wz) - 0.5*wy*(2.0*Bx2*q1 + 2.0*By2*q2 + 2.0*Bz2*q3) - 0.5*wz*(2.0*Bx2*q0 + 2.0*By2*q3 - 2.0*Bz2*q2) - 2.0*Bx2*(0.5*q1*wy - 0.5*q2*wx + 0.5*q0*wz) - 2.0*By2*(0.5*q1*wx + 0.5*q2*wy + 0.5*q3*wz) - 0.5*wx*(2.0*Bx2*q2 - 2.0*By2*q1 + 2.0*Bz2*q0), 0.5*wx*(2.0*Bx2*q1 + 2.0*By2*q2 + 2.0*Bz2*q3) - 0.5*wy*(2.0*Bx2*q2 - 2.0*By2*q1 + 2.0*Bz2*q0) - 0.5*wz*(2.0*By2*q0 - 2.0*Bx2*q3 + 2.0*Bz2*q1) + 2.0*Bx2*(0.5*q1*wx + 0.5*q2*wy + 0.5*q3*wz) - 2.0*By2*(0.5*q1*wy - 0.5*q2*wx + 0.5*q0*wz) + 2.0*Bz2*(0.5*q3*wx + 0.5*q0*wy - 0.5*q1*wz), 0.5*wx*(2.0*Bx2*q0 + 2.0*By2*q3 - 2.0*Bz2*q2) + 0.5*wy*(2.0*By2*q0 - 2.0*Bx2*q3 + 2.0*Bz2*q1) - 0.5*wz*(2.0*Bx2*q2 - 2.0*By2*q1 + 2.0*Bz2*q0) + 2.0*Bx2*(0.5*q0*wx - 0.5*q3*wy + 0.5*q2*wz) + 2.0*By2*(0.5*q3*wx + 0.5*q0*wy - 0.5*q1*wz) + 2.0*Bz2*(0.5*q1*wy - 0.5*q2*wx + 0.5*q0*wz);
                1.0,   0,   0,                                    0,                                    0,                                    0,                                    0,                                    0,                                    0, 0,                                                                                                                                                                                                                                                                                  0.8*wz,                                                                                                                                                                                                                                                                                 -0.8*wy,                                                                                           0.5*q0*(2.0*Bx1*q1 + 2.0*By1*q2 + 2.0*Bz1*q3) - 0.5*q1*(2.0*Bx1*q0 + 2.0*By1*q3 - 2.0*Bz1*q2) - 0.5*q2*(2.0*By1*q0 - 2.0*Bx1*q3 + 2.0*Bz1*q1) - 0.5*q3*(2.0*Bx1*q2 - 2.0*By1*q1 + 2.0*Bz1*q0),                                                                                           0.5*q0*(2.0*Bx1*q2 - 2.0*By1*q1 + 2.0*Bz1*q0) - 0.5*q1*(2.0*By1*q0 - 2.0*Bx1*q3 + 2.0*Bz1*q1) + 0.5*q2*(2.0*Bx1*q0 + 2.0*By1*q3 - 2.0*Bz1*q2) + 0.5*q3*(2.0*Bx1*q1 + 2.0*By1*q2 + 2.0*Bz1*q3),                                                                                           0.5*q3*(2.0*Bx1*q0 + 2.0*By1*q3 - 2.0*Bz1*q2) - 0.5*q1*(2.0*Bx1*q2 - 2.0*By1*q1 + 2.0*Bz1*q0) - 0.5*q2*(2.0*Bx1*q1 + 2.0*By1*q2 + 2.0*Bz1*q3) - 0.5*q0*(2.0*By1*q0 - 2.0*Bx1*q3 + 2.0*Bz1*q1),                                                                                           0.5*q0*(2.0*Bx2*q1 + 2.0*By2*q2 + 2.0*Bz2*q3) - 0.5*q1*(2.0*Bx2*q0 + 2.0*By2*q3 - 2.0*Bz2*q2) - 0.5*q2*(2.0*By2*q0 - 2.0*Bx2*q3 + 2.0*Bz2*q1) - 0.5*q3*(2.0*Bx2*q2 - 2.0*By2*q1 + 2.0*Bz2*q0),                                                                                           0.5*q0*(2.0*Bx2*q2 - 2.0*By2*q1 + 2.0*Bz2*q0) - 0.5*q1*(2.0*By2*q0 - 2.0*Bx2*q3 + 2.0*Bz2*q1) + 0.5*q2*(2.0*Bx2*q0 + 2.0*By2*q3 - 2.0*Bz2*q2) + 0.5*q3*(2.0*Bx2*q1 + 2.0*By2*q2 + 2.0*Bz2*q3),                                                                                           0.5*q3*(2.0*Bx2*q0 + 2.0*By2*q3 - 2.0*Bz2*q2) - 0.5*q1*(2.0*Bx2*q2 - 2.0*By2*q1 + 2.0*Bz2*q0) - 0.5*q2*(2.0*Bx2*q1 + 2.0*By2*q2 + 2.0*Bz2*q3) - 0.5*q0*(2.0*By2*q0 - 2.0*Bx2*q3 + 2.0*Bz2*q1);
                0, 1.0,   0,                                    0,                                    0,                                    0,                                    0,                                    0,                                    0, 0,                                                                                                                                                                                                                                                                                       0,                                                                                                                                                                                                                                                                                 -0.8*wx,                                                                                           0.5*q1*(2.0*By1*q0 - 2.0*Bx1*q3 + 2.0*Bz1*q1) - 0.5*q0*(2.0*Bx1*q2 - 2.0*By1*q1 + 2.0*Bz1*q0) - 0.5*q2*(2.0*Bx1*q0 + 2.0*By1*q3 - 2.0*Bz1*q2) - 0.5*q3*(2.0*Bx1*q1 + 2.0*By1*q2 + 2.0*Bz1*q3),                                                                                           0.5*q0*(2.0*Bx1*q1 + 2.0*By1*q2 + 2.0*Bz1*q3) - 0.5*q1*(2.0*Bx1*q0 + 2.0*By1*q3 - 2.0*Bz1*q2) - 0.5*q2*(2.0*By1*q0 - 2.0*Bx1*q3 + 2.0*Bz1*q1) - 0.5*q3*(2.0*Bx1*q2 - 2.0*By1*q1 + 2.0*Bz1*q0),                                                                                           0.5*q0*(2.0*Bx1*q0 + 2.0*By1*q3 - 2.0*Bz1*q2) - 0.5*q2*(2.0*Bx1*q2 - 2.0*By1*q1 + 2.0*Bz1*q0) + 0.5*q1*(2.0*Bx1*q1 + 2.0*By1*q2 + 2.0*Bz1*q3) + 0.5*q3*(2.0*By1*q0 - 2.0*Bx1*q3 + 2.0*Bz1*q1),                                                                                           0.5*q1*(2.0*By2*q0 - 2.0*Bx2*q3 + 2.0*Bz2*q1) - 0.5*q0*(2.0*Bx2*q2 - 2.0*By2*q1 + 2.0*Bz2*q0) - 0.5*q2*(2.0*Bx2*q0 + 2.0*By2*q3 - 2.0*Bz2*q2) - 0.5*q3*(2.0*Bx2*q1 + 2.0*By2*q2 + 2.0*Bz2*q3),                                                                                           0.5*q0*(2.0*Bx2*q1 + 2.0*By2*q2 + 2.0*Bz2*q3) - 0.5*q1*(2.0*Bx2*q0 + 2.0*By2*q3 - 2.0*Bz2*q2) - 0.5*q2*(2.0*By2*q0 - 2.0*Bx2*q3 + 2.0*Bz2*q1) - 0.5*q3*(2.0*Bx2*q2 - 2.0*By2*q1 + 2.0*Bz2*q0),                                                                                           0.5*q0*(2.0*Bx2*q0 + 2.0*By2*q3 - 2.0*Bz2*q2) - 0.5*q2*(2.0*Bx2*q2 - 2.0*By2*q1 + 2.0*Bz2*q0) + 0.5*q1*(2.0*Bx2*q1 + 2.0*By2*q2 + 2.0*Bz2*q3) + 0.5*q3*(2.0*By2*q0 - 2.0*Bx2*q3 + 2.0*Bz2*q1);
                0,   0, 1.0,                                    0,                                    0,                                    0,                                    0,                                    0,                                    0, 0,                                                                                                                                                                                                                                                                                  0.8*wx,                                                                                                                                                                                                                                                                                       0,                                                                                           0.5*q0*(2.0*By1*q0 - 2.0*Bx1*q3 + 2.0*Bz1*q1) + 0.5*q1*(2.0*Bx1*q2 - 2.0*By1*q1 + 2.0*Bz1*q0) + 0.5*q2*(2.0*Bx1*q1 + 2.0*By1*q2 + 2.0*Bz1*q3) - 0.5*q3*(2.0*Bx1*q0 + 2.0*By1*q3 - 2.0*Bz1*q2),                                                                                           0.5*q2*(2.0*Bx1*q2 - 2.0*By1*q1 + 2.0*Bz1*q0) - 0.5*q0*(2.0*Bx1*q0 + 2.0*By1*q3 - 2.0*Bz1*q2) - 0.5*q1*(2.0*Bx1*q1 + 2.0*By1*q2 + 2.0*Bz1*q3) - 0.5*q3*(2.0*By1*q0 - 2.0*Bx1*q3 + 2.0*Bz1*q1),                                                                                           0.5*q0*(2.0*Bx1*q1 + 2.0*By1*q2 + 2.0*Bz1*q3) - 0.5*q1*(2.0*Bx1*q0 + 2.0*By1*q3 - 2.0*Bz1*q2) - 0.5*q2*(2.0*By1*q0 - 2.0*Bx1*q3 + 2.0*Bz1*q1) - 0.5*q3*(2.0*Bx1*q2 - 2.0*By1*q1 + 2.0*Bz1*q0),                                                                                           0.5*q0*(2.0*By2*q0 - 2.0*Bx2*q3 + 2.0*Bz2*q1) + 0.5*q1*(2.0*Bx2*q2 - 2.0*By2*q1 + 2.0*Bz2*q0) + 0.5*q2*(2.0*Bx2*q1 + 2.0*By2*q2 + 2.0*Bz2*q3) - 0.5*q3*(2.0*Bx2*q0 + 2.0*By2*q3 - 2.0*Bz2*q2),                                                                                           0.5*q2*(2.0*Bx2*q2 - 2.0*By2*q1 + 2.0*Bz2*q0) - 0.5*q0*(2.0*Bx2*q0 + 2.0*By2*q3 - 2.0*Bz2*q2) - 0.5*q1*(2.0*Bx2*q1 + 2.0*By2*q2 + 2.0*Bz2*q3) - 0.5*q3*(2.0*By2*q0 - 2.0*Bx2*q3 + 2.0*Bz2*q1),                                                                                           0.5*q0*(2.0*Bx2*q1 + 2.0*By2*q2 + 2.0*Bz2*q3) - 0.5*q1*(2.0*Bx2*q0 + 2.0*By2*q3 - 2.0*Bz2*q2) - 0.5*q2*(2.0*By2*q0 - 2.0*Bx2*q3 + 2.0*Bz2*q1) - 0.5*q3*(2.0*Bx2*q2 - 2.0*By2*q1 + 2.0*Bz2*q0)];

 
    
    
end